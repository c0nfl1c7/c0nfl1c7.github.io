<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        Qu&#39;est-ce que le Type Juggling en PHP ? ::
        infosec blog — c0nfl1c7
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Introduction # PHP est un langage de backend très répandu et flexible, qui tend à faciliter la vie des développeurs. Malheuresement, cette flexibilité peut parfois mener à des failles de sécurité plus ou moins critiques.
Un bon exemple de ceci est le type juggling en PHP. Cette fonctionnalité permet aux developeurs d&amp;rsquo;être plus flexibles quand ils utilisent le langage, mais elle peut aussi s&amp;rsquo;avérer assez dangereuse si elle n&amp;rsquo;est pas utilisée précautionneusement."
/>
<meta
  name="keywords"
  content="infosec writeups french cybersec"
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="/post/php_type_juggling/" />







<link rel="stylesheet" href="/css/style.css" />

<link rel="stylesheet" href="/style.css" />


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png" />
<link rel="shortcut icon" href="/img/favicon.png" />


<link href="/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Qu&#39;est-ce que le Type Juggling en PHP ?"/>
<meta name="twitter:description" content="En cette nouvelle année je m&#39;essaye à un nouveau format, j&#39;espère que cet article est clair et que vous pourrez apprendre de nouvelles choses"/>



<meta property="og:title" content="Qu&#39;est-ce que le Type Juggling en PHP ?" />
<meta property="og:description" content="En cette nouvelle année je m&#39;essaye à un nouveau format, j&#39;espère que cet article est clair et que vous pourrez apprendre de nouvelles choses" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/php_type_juggling/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-01-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-01-07T00:00:00+00:00" /><meta property="og:site_name" content="infosec blog" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >c0nfl1c7</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/archive">Archive</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/archive">Archive</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <article class="post">
    <h1 class="post-title">Qu&rsquo;est-ce que le Type Juggling en PHP ?</h1>
    <div class="post-meta">
      
        <time class="post-date">
          07-01-2023
        </time>

        
          
        
      

      
        <span class="post-author"
          >— écrit par conflict</span
        >


      
        <span class="post-read-time"
          >— 7 minute(s) de lecture</span
        >
      
    </div>

    

    

    <div class="post-content">
      
      <h1 id="introduction">
  Introduction
  <a href="#introduction" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>PHP est un langage de backend très répandu et flexible, qui tend à faciliter la vie des développeurs. Malheuresement, cette flexibilité peut parfois mener à des failles de sécurité plus ou moins critiques.</p>
<p>Un bon exemple de ceci est le <strong>type juggling</strong> en PHP. Cette fonctionnalité permet aux developeurs d&rsquo;être plus flexibles quand ils utilisent le langage, mais elle peut aussi s&rsquo;avérer assez dangereuse si elle n&rsquo;est pas utilisée précautionneusement.  On retrouve assez régulièrement des challenges sur ce sujet donc j&rsquo;éspère que cet article va vous aider à mieux le comprendre.</p>
<p>Je vais tout d&rsquo;abord expliquer ce qu&rsquo;est concrètement le <strong>type juggling</strong>  puis pourquoi cela peut causer des problèmes de sécurité et enfin je donnerai quelques exemples et mises en situation.</p>
<h1 id="les-comparaisons-en-php">
  Les comparaisons en PHP
  <a href="#les-comparaisons-en-php" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>PHP possède une fonctionnalité appellée &ldquo;type juggling&rdquo;. Cette dernière signifie que quand PHP compare deux valeures de type différent, elles seront converties dans un même type avant d&rsquo;être comparées.</p>
<p>Par exemple:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures sont égales&#34;</span>;
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures ne sont pas égales&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Ce code compare donc un <strong>string</strong> (un texte) et un <strong>integer</strong> (un nombre) et nous indique si les deux membres comparés sont égaux.</p>
<p>En l&rsquo;occurence, ce script écrira que les deux valeures sont égales, et cela grâce au <strong>type juggling</strong>.</p>
<p>Lors de l&rsquo;éxecution et plus précisément lors de la comparaison, le deuxième 1, l&rsquo;<strong>integer</strong>, va être converti en un <strong>string</strong> et il sera comparé seulement après ceci.</p>
<p>Cela revient donc à faire:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;1&#34;</span>)
</span></span></code></pre></div><p>Or, cette condition est vraie</p>
<p>Cette fonctionnalité peut vraiment faciliter la vie quand on travaille avec plusieurs types de variables différents et des entrées utilisateurs, mais elle peut aussi être très dangereuse</p>
<h1 id="doù-vient-la-faille-">
  D&rsquo;où vient la faille ?
  <a href="#do%c3%b9-vient-la-faille-" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>La faille est en réalité très simpe et logique, probablement même pour quelqu&rsquo;un qui ne connaît pas PHP. Re-prennons notre exemple de tout à l&rsquo;heure, en le modifiant un petit peu pour l&rsquo;illustrer:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;1 2 3 soleil&#34;</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures sont égales&#34;</span>;
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures ne sont pas égales&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Maintenant, que pensez-vous que ce code va retourner ?</p>
<p>A cause du type juggling, et contre toute attente, ce code va écrire que les deux valeures comparées sont égales, or, elles ne le sont pas du tout.</p>
<p>Ce qui se passe concrètement au moment de la comparaison est que PHP va tenter de récupérer un <strong>integer</strong> dans la chaine de caractères donnée, il va donc en l&rsquo;occurence trouver <strong>1</strong> et donc valider la condition.</p>
<p>Que se passe-t-il si on modifie une seconde fois la condition en retirant le 1 ?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;2 3 soleil&#34;</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures sont égales&#34;</span>;
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures ne sont pas égales&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Cette fois ci, la condition sera <strong>false</strong> et le programme dirai que les deux valeures ne sont pas égales puisque PHP va comparer 2 et 1, qui sont deux chiffres différents.</p>
<p>Mais la faille ne s&rsquo;arrête pas là, voici ce qui se passe si au lieu de comparer un <strong>string</strong> à 1, on le compare à 0:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;Hello World&#34;</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures sont égales&#34;</span>;
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures ne sont pas égales&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Dans ce cas de figure, la condition va être validée car PHP va une fois de plus tenter de changer le type de la chaîne de caractère en un chiffre, or, et ceci est valable peu importe si il y a un chiffre dans la chaine de caractère ou non, <code>la valeur décimale de la chaine de caractère est 0</code>.</p>
<h1 id="semi-patched">
  Semi-Patched
  <a href="#semi-patched" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>Tout les exemples que nous venons de voir ont été faits sous PHP 7.X, mais ce n&rsquo;est pas la dernière version de PHP disponible, la dernière en date étant PHP 8.</p>
<p>Cette nouvelle version a notamment apporté des changements concernant le <strong>type juggling</strong>. Pour expliquer cela le plus simplement possible, la fonctionnalité a été rendue &ldquo;plus intelligente&rdquo;. J&rsquo;entends par là qu&rsquo;elle va modifier les types des valeures pour éviter un maximum les <strong>false positive</strong> (comparaison validée alors que les deux valeures ne son pas égales)</p>
<p>Reprenons notre exemple précdent et voyons le résultat en PHP 8</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;Hello World&#34;</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures sont égales&#34;</span>;
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures ne sont pas égales&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>En PHP 8, au moment de la comparaison, au lieu de tenter de récupérer la valeur <strong>integer</strong> de la chaine de caractères, il va tout simplement changer le 0 en un <strong>string</strong>, la condition devindra donc:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;Hello World&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;0&#34;</span>)
</span></span></code></pre></div><p>Or cette condition est fausse, le programme nous dira donc que les deux valeures ne sont pas égales.</p>
<p>Mais, cette partie ne s&rsquo;appellerait pas <strong>semi</strong>-patched si le problème était totalement réglé. En effet, il reste encore certaines vulnérabilités à ce système, par exemple:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#ae81ff">123456789</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">123456789.0000000000</span>){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures sont égales&#34;</span>;
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Les deux valeures ne sont pas égales&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Lors de la comparaison, la deuxième valeur, qui est un <strong>float</strong> (nombre à virgule) va être transformée en un <strong>integer</strong> (nombre entier), sauf qu&rsquo;elle sera en même temps simplifiée et donc cette condition deviendra alors vraie.</p>
<p>Bien évidemment, c&rsquo;est un cas moins grave puisque mathématiquement, ces deux nombres sont bel et bien égaux.</p>
<p>Voici un tableau qui illustre les différents résultats lors d&rsquo;une <strong>loose comparison</strong> (comparaison avec deux &ldquo;=&rdquo; et non trois, où le type juggling intervient) en <strong>PHP 7</strong></p>
<p><img src="https://user-images.githubusercontent.com/77807503/211122304-a2f5f310-ddbb-4b71-b8e2-63d9406de2d9.png" alt="Pasted image 20230107010517"></p>
<h1 id="exemples-plus-concrets">
  Exemples plus concrets
  <a href="#exemples-plus-concrets" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>Je vais illustrer cette partie avec un challenge &ldquo;PHP type juggling&rdquo; que j&rsquo;ai fait pour l&rsquo;exemple.</p>
<p>Voici le backend de l&rsquo;une page de connection:</p>
<blockquote>
<p>Je vais essayer d&rsquo;expliquer le code un maximum, donc ne vous inquiétez pas si vous ne connaissez pas PHP ou même que vous découvrez le langage (+ le code est simple)</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">session_start</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">isset</span>($_POST[<span style="color:#e6db74">&#39;password&#39;</span>]) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">isset</span>($_POST[<span style="color:#e6db74">&#39;username&#39;</span>])
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	$username <span style="color:#f92672">=</span> $_POST[<span style="color:#e6db74">&#39;username&#39;</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span>($username <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;admin&#34;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">strcmp</span>(<span style="color:#a6e22e">bin2hex</span>(<span style="color:#a6e22e">openssl_random_pseudo_bytes</span>(<span style="color:#ae81ff">10</span>)),$_POST[<span style="color:#e6db74">&#39;password&#39;</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		$_SESSION[<span style="color:#e6db74">&#39;isAdmin&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Location:admin.php&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Location:index.php?error=credentials&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Tout d&rsquo;abord, on s&rsquo;assure que les deux paramètres POST (utilisés pour passer le nom d&rsquo;utilisateur et le mot de passe) ne sont pas vides. Cette ligne n&rsquo;est pas vulnérable, elle permet juste de vérifier que la requête envoyée n&rsquo;est pas vide</p>
<p>La vulnérabilité se trouve dans la condition suivante, celle qui vérifie le mot de passe. La fonction <strong>strcmp</strong> est utilisée pour comparer un mot de passe aléatoire à l&rsquo;entrée de notre utilisateur.</p>
<blockquote>
<p>On compare l&rsquo;entrée utilisateur à un mot de passe généré aléatoirement (et donc impossible à deviner) car le but n&rsquo;est pas d&rsquo;avoir le mot de passe mais de contourner la condition</p>
</blockquote>
<p>La fonction <strong>strcmp</strong> compare deux <strong>strings</strong>, et retourne 0 si les deux strings sont égaux, la condition vérifie ici que <strong>strcmp</strong> retourne 0, ce qui veux dire que le mot de passe entré est égal au mot de passe généré aléatoirement.</p>
<p>On voit en revanche que cette vérification se fait avec une <strong>loose comparison</strong> (seulement deux &ldquo;=&rdquo; utilisés), donc on peut potentiellement créer un false positive (cf. le tableau des loose comparison)</p>
<p>Il faut savoir que la fonction <strong>strcmp</strong> retourne <strong>NULL</strong> si un des deux arguments qu&rsquo;on lui donne n&rsquo;est pas un <strong>string</strong> (une chaine de caractères). Sachant ça, il suffit d&rsquo;entrer autre chose qu&rsquo;un <strong>string</strong> pour le mot de passe, et la fonction retournera <strong>NULL</strong>.</p>
<p>Et, si on s&rsquo;en remet au tableau des <strong>loose comparison</strong>, <strong>NULL</strong> == <strong>0</strong> est <strong>true</strong>, donc la comparaison sera validée, comme si le bon mot de passe avait été entré.</p>
<h1 id="comment-éviter-les-problèmes-type-juggling-">
  Comment éviter les problèmes type juggling ?
  <a href="#comment-%c3%a9viter-les-probl%c3%a8mes-type-juggling-" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>Il n&rsquo;a pas de méthode miracle pour éviter ces problèmes, mais il est fortement conseillé d&rsquo;utiliser des comparaisons strictes (utiliser trois &ldquo;=&rdquo; au lieu de deux) le plus possible voir tout le temps.</p>
<p>Sinon, une autre méthode pour patcher ceci dans le cadre du challenge serait de vérifier au préalable que l&rsquo;utilisateur a bien entré un <strong>string</strong> (never trust user input!).</p>
<h1 id="conclusion--sentraîner">
  Conclusion + S&rsquo;entraîner
  <a href="#conclusion--sentra%c3%aener" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>PHP est globalement un bon langage, flexible et surtout facile à prendre en main. Mais tous ces avantages ont un prix, une erreur d&rsquo;inatention peut exposer une application à de grosses vulnérabilitées, et c&rsquo;est aussi pour cela qu&rsquo;il est important de comprendre comment fonctionne PHP.</p>
<p>J&rsquo;espère que cet article vous a aidé à mieux comprendre ce qu&rsquo;est le <strong>type juggling</strong>, si vous avez des question vous pouvez me contacter sur <a href="/about">discord</a></p>
<h1 id="quelques-liens-pour-sentraîner">
  Quelques liens pour s&rsquo;entraîner:
  <a href="#quelques-liens-pour-sentra%c3%aener" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p><a href="https://theblackside.fr/challenges/web/PHP---Quirk">https://theblackside.fr/challenges/web/PHP---Quirk</a></p>
<p><a href="https://theblackside.fr/challenges/web/super_secure_local_access">https://theblackside.fr/challenges/web/super_secure_local_access</a></p>
<p><a href="https://www.root-me.org/en/Challenges/Web-Server/PHP-type-juggling">https://www.root-me.org/en/Challenges/Web-Server/PHP-type-juggling</a></p>
<h1 id="tout-savoir-sur-le-sujet-anglais">
  Tout savoir sur le sujet (anglais):
  <a href="#tout-savoir-sur-le-sujet-anglais" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p><a href="https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf">https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf</a></p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >voir d&#39;autres posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
            
              <span class="button next">
                <a href="/post/thm-anonymous/">
                  <span class="button__text">TryHackMe - Anonymous - Medium</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </article>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">rami malek en personne</div>
      
  </div>
</footer>





<script type="text/javascript" src="/bundle.min.js"></script>


      
    </div>

    
  </body>
</html>
